!function t(e,i,r){function n(s,a){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(o)return o(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return n(i?i:t)},l,l.exports,t,e,i,r)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){var r={0:{density:1,hp:1,damage:10,alias:"normal",radius:8,duration:900,velocity:{ivMax:300,ivDec:50,evMax:100,springBase:30,rv:0,ivMin:200,springAdd:10,ivAcc:200,ivInit:300,evDec:80},view:{body:{color:"0xf14e54",playerColor:"0x00b2e1",radius:7},edge:{color:"0x555555",w:2}}}};e.exports=r},{}],2:[function(t,e,i){var r={0:{scaleIncrease:.1,alias:"base",alphaStart:.4,alphaEnd:.1,alphaDecrease:.1}};e.exports=r},{}],3:[function(t,e,i){var r={0:{alias:"base",view:{color:"0x86c680",h:20,edge:{color:"0x555555",w:4},radius:10,w:100,alpha:.75}}};e.exports=r},{}],4:[function(t,e,i){var r={0:{color:"0x808080",h:2048,obstacleRegion:{color:"0xcdcdcd",wRatio:.92,hRatio:.92},w:2048,view:{grid:{color:"0xa0a0a0",edge:1,size:32}}}};e.exports=r},{}],5:[function(t,e,i){var r={0:{density:1,hp:20,damage:2,alias:"triangle",radius:20,velocity:{ivMax:3,ivDec:0,evMax:120,springBase:30,rv:.5,ivMin:3,springAdd:10,ivAcc:0,ivInit:3,evDec:80},view:{color:"0xfc7676",hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5},radius:20,side:3}},1:{density:1,hp:40,damage:4,alias:"quad",radius:20,velocity:{ivMax:3,ivDec:0,evMax:100,springBase:30,rv:.5,ivMin:3,springAdd:10,ivAcc:0,ivInit:3,evDec:80},view:{color:"0xffe869",hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5},radius:20,side:4}},2:{density:1,hp:80,damage:8,alias:"pentagon",radius:24,velocity:{ivMax:3,ivDec:0,evMax:80,springBase:30,rv:.5,ivMin:3,springAdd:10,ivAcc:0,ivInit:3,evDec:80},view:{color:"0x768dfc",hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5},radius:24,side:5}}};e.exports=r},{}],6:[function(t,e,i){var r={0:{density:1,hp:200,damage:10,weapons:{1:"",0:"base",3:"",2:""},alias:"base",radius:24,velocity:{ivMax:160,ivDec:200,evMax:120,springBase:30,rv:0,ivMin:0,springAdd:10,ivAcc:400,ivInit:0,evDec:80},view:{body:{color:"0xf14e54",playerColor:"0x00b2e1",radius:22},hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5}}},1:{density:1,hp:300,damage:10,weapons:{1:"twin-right",0:"twin-left",3:"",2:""},alias:"twin",radius:26,velocity:{ivMax:160,ivDec:200,evMax:120,springBase:30,rv:0,ivMin:0,springAdd:10,ivAcc:400,ivInit:0,evDec:80},view:{body:{color:"0xf14e54",playerColor:"0x00b2e1",radius:24},hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5}}},2:{density:1,hp:400,damage:10,weapons:{1:"quad-right",0:"quad-up",3:"quad-left",2:"quad-down"},alias:"quad",radius:26,velocity:{ivMax:160,ivDec:200,evMax:120,springBase:30,rv:0,ivMin:0,springAdd:10,ivAcc:400,ivInit:0,evDec:80},view:{body:{color:"0xf14e54",playerColor:"0x00b2e1",radius:24},hpbar:{scaleYRatio:.6,scaleXRatio:.6,yOffsetRatio:1.4,xOffsetRatio:0},edge:{color:"0x555555",w:2.5}}}};e.exports=r},{}],7:[function(t,e,i){var r={0:{disturbDeg:15,fireAnimDistance:5,angle:0,bullet:"normal",shootOffset:45,alias:"base",fireAnimFrame:16,recoil:1e4,reloadFrame:10,y:0,x:0,shootDelayFrame:3,view:{color:"0x999999",h:35,edge:{color:"0x555555",w:2},w:15}},1:{disturbDeg:15,fireAnimDistance:5,angle:0,bullet:"normal",shootOffset:50,alias:"twin-left",fireAnimFrame:16,recoil:8e3,reloadFrame:10,y:0,x:-8,shootDelayFrame:3,view:{color:"0x999999",h:40,edge:{color:"0x555555",w:2},w:12}},2:{disturbDeg:15,fireAnimDistance:5,angle:0,bullet:"normal",shootOffset:50,alias:"twin-right",fireAnimFrame:16,recoil:8e3,reloadFrame:10,y:0,x:8,shootDelayFrame:6,view:{color:"0x999999",h:40,edge:{color:"0x555555",w:2},w:12}},3:{disturbDeg:15,fireAnimDistance:5,angle:0,bullet:"normal",shootOffset:48,alias:"quad-up",fireAnimFrame:16,recoil:1e4,reloadFrame:10,y:0,x:0,shootDelayFrame:3,view:{color:"0x999999",h:38,edge:{color:"0x555555",w:2},w:16}},4:{disturbDeg:15,fireAnimDistance:5,angle:90,bullet:"normal",shootOffset:48,alias:"quad-right",fireAnimFrame:16,recoil:1e4,reloadFrame:10,y:0,x:0,shootDelayFrame:6,view:{color:"0x999999",h:38,edge:{color:"0x555555",w:2},w:16}},5:{disturbDeg:15,fireAnimDistance:5,angle:180,bullet:"normal",shootOffset:48,alias:"quad-down",fireAnimFrame:16,recoil:1e4,reloadFrame:10,y:0,x:0,shootDelayFrame:3,view:{color:"0x999999",h:38,edge:{color:"0x555555",w:2},w:16}},6:{disturbDeg:15,fireAnimDistance:5,angle:270,bullet:"normal",shootOffset:48,alias:"quad-left",fireAnimFrame:16,recoil:1e4,reloadFrame:10,y:0,x:0,shootDelayFrame:6,view:{color:"0x999999",h:38,edge:{color:"0x555555",w:2},w:16}}};e.exports=r},{}],8:[function(t,e,i){var r={0:{maxObstaclesCount:50,frame:30,gridSize:128,unitCollideCheckMS:500}};e.exports=r},{}],9:[function(t,e,i){!function(){"use strict";function i(t,e,i,o,s,a,h){this.owner=s,this.weaponName=a,this.bornTime=t.time,r.call(this,t,n.unitType.bullet,t.cfg.configBullets[e],i,o,h)}var r=t("../modules/unit"),n=t("../modules/util");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.outOfDate=function(){return this.world.time>this.bornTime+this.cfg.duration},e.exports=i}()},{"../modules/unit":20,"../modules/util":21}],10:[function(t,e,i){!function(){"use strict";function i(t){this.world=t}var r=t("../modules/bullet"),n=t("../modules/obstacle"),o=t("../modules/tank"),s=t("../modules/util");i.prototype={constructor:i},i.prototype.createUnit=function(t,e){var i=null;switch(t.type){case s.unitType.tank:i=new o(this.world,t.cfgName,t.motion.position,null,!0,e);break;case s.unitType.bullet:if(i=new r(this.world,t.cfgName,t.motion.position,0,this.world.findUnit(t.ownerid),t.weaponName,!0),i.bornTime=t.bornTime,i.owner){var a=i.owner.getWeaponByName(t.weaponName);a&&a.fireBullet(i)}break;case s.unitType.obstacle:i=new n(this.world,t.cfgName,t.motion.position,!0);break;default:console.log("ignore unit type="+t.type)}return i&&(i.id=t.id,i.motion.ev.x=t.motion.ev.x,i.motion.ev.y=t.motion.ev.y,i.motion.iv.x=t.motion.iv.x,i.motion.iv.y=t.motion.iv.y,i.motion.moveDir.x=t.motion.moveDir.x,i.motion.moveDir.y=t.motion.moveDir.y,i.rotation=t.rotation,i.hp=t.hp,this.world.addUnit(i)),i},i.prototype.createPlayer=function(t){var e=this.world.addPlayer(t.connid,t.name,t.vw,t.vh);if(t.die===!1){var i=this.world.findUnit(t.id);i?e.bindTank(i):console.log("player["+t.connid+"] tank["+t.id+"] not found")}return t.connid===this.world.connid&&(console.log("player connid="+t.connid),e.addControl()),e},i.prototype.onStartRes=function(t){var e=this.world.proto.ErrCode;if(t.result!=e.SUCCESS)return void alert("start fail:"+t.result);var i=t.syncStartRes;this.world.connid=i.connid;var r;for(r in i.units){var n=i.units[r],o=this.world.findUnit(n.id);o?o.load(n):this.createUnit(n,n.id===i.id)}for(r in i.players)this.createPlayer(i.players[r])},i.prototype.onOperation=function(t){var e=t.syncOperation,i=this.world.players[e.connid];return i?void(i.tank&&(e.connid==this.world.connid?i.tank.motion.setMoveDir(e.moveDirX,e.moveDirY):(i.tank.autoFire=e.fire,i.tank.rotation=e.rotation,i.tank.motion.setMoveDir(e.moveDirX,e.moveDirY)))):void console.log("player["+e.connid+"] not found")},i.prototype.onSyncUnits=function(t){for(var e in t.syncUnits.units){var i=t.syncUnits.units[e],r=this.world.findUnit(i.id);r?r.load(i):this.createUnit(i)}},i.prototype.onSyncUnitDie=function(t){var e=this.world.findUnit(t.syncUnitDie.id);e&&e.die()},i.prototype.onSyncPlayerJoin=function(t){t.syncPlayerJoin.player.connid!==this.world.connid&&this.createPlayer(t.syncPlayerJoin.player)},i.prototype.onSyncPlayerQuit=function(t){this.world.removePlayer(t.syncPlayerQuit.connid)},i.prototype.onSyncCollision=function(t){var e=t.syncCollision,i=this.world.findUnit(e.u1.id);i&&i.isDead===!1&&i.load(e.u1);var r=this.world.findUnit(e.u2.id);r&&r.isDead===!1&&r.load(e.u2)},i.prototype.onMessage=function(t){var e=this.world.proto.Pkg.decode(t),i=this.world.proto.SyncCmd;if(null!==this.world.connid||e.cmd==i.SYNC_START_RES)switch(e.cmd){case i.SYNC_START_RES:this.onStartRes(e);break;case i.SYNC_OPERATION:this.onOperation(e);break;case i.SYNC_UNITS:this.onSyncUnits(e);break;case i.SYNC_UNIT_DIE:this.onSyncUnitDie(e);break;case i.SYNC_PLAYER_JOIN:this.onSyncPlayerJoin(e);break;case i.SYNC_PLAYER_QUIT:this.onSyncPlayerQuit(e);break;case i.SYNC_COLLISION:this.onSyncCollision(e);break;default:console.log("invalid cmd="+e.cmd)}},e.exports=i}()},{"../modules/bullet":9,"../modules/obstacle":16,"../modules/tank":19,"../modules/util":21}],11:[function(t,e,i){function r(){"use strict";o.update(),requestAnimationFrame(r)}var n=t("../modules/cworld"),o=new n;o.start(),r()},{"../modules/cworld":13}],12:[function(t,e,i){!function(){"use strict";function i(){var t;this.configBullets={};for(t in r)this.configBullets[r[t].alias]=r[t];this.configDieAnimation={};for(t in n)this.configDieAnimation[n[t].alias]=n[t];this.configHpbar={};for(t in o)this.configHpbar[o[t].alias]=o[t];this.configObstacles={};for(t in s)this.configObstacles[s[t].alias]=s[t];this.configTanks={};for(t in a)this.configTanks[a[t].alias]=a[t];this.configWeapons={};for(t in h)this.configWeapons[h[t].alias]=h[t];this.configMap=f[0],this.configWorld=l[0],this.configApp={domain:"tank.gaccob.com",port:9e3,proto:"tank.proto.json",maxOnline:30}}var r=t("../cfg/configBullets"),n=t("../cfg/configDieAnimation"),o=t("../cfg/configHpbar"),s=t("../cfg/configObstacles"),a=t("../cfg/configTanks"),h=t("../cfg/configWeapons"),f=t("../cfg/configMap"),l=t("../cfg/configWorld");e.exports=i}()},{"../cfg/configBullets":1,"../cfg/configDieAnimation":2,"../cfg/configHpbar":3,"../cfg/configMap":4,"../cfg/configObstacles":5,"../cfg/configTanks":6,"../cfg/configWeapons":7,"../cfg/configWorld":8}],13:[function(t,e,i){!function(){"use strict";function i(t){var e=t.cfg.configMap,i=new PIXI.Graphics;i.beginFill(e.obstacleRegion.color),i.drawRect(t.spawnRegion.x,t.spawnRegion.y,t.spawnRegion.w,t.spawnRegion.h),i.endFill(),i.lineStyle(e.view.grid.edge,e.view.grid.color);for(var r=e.view.grid.size;r<t.w;r+=e.view.grid.size)i.moveTo(r,0),i.lineTo(r,t.h);for(var n=e.view.grid.size;n<t.h;n+=e.view.grid.size)i.moveTo(0,n),i.lineTo(t.w,n);return i}function r(){h.call(this),this.isLocal=!0,this.stage=new PIXI.Container,this.view=new PIXI.Container,this.view.addChild(i(this)),this.stage.addChild(this.view),this.ui=new PIXI.Container,this.stage.addChild(this.ui),this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight-10,this.renderer=new PIXI.CanvasRenderer(this.viewW,this.viewH,{backgroundColor:Number(this.cfg.configMap.color),antialias:!0,autoResize:!0}),document.body.appendChild(this.renderer.view),this.dieSprites=[];var t=o.loadJsonFile(this.cfg.configApp.proto);this.proto=t.build("Tank"),this.synchronizer=new a(this),this.dispatcher=new s(this),this.connid=null}var n=t("socket.io-client"),o=t("protobufjs"),s=t("../modules/cdispatcher"),a=t("../modules/synchronizer"),h=t("../modules/world"),f=t("../modules/util");r.prototype=Object.create(h.prototype),r.prototype.constructor=r,r.prototype.getSelf=function(){return this.connid?this.players[this.connid]:null},r.prototype.updateCamera=function(){var t=this.getSelf();if(t){var e=t.x,i=t.y,r=this.viewW/2,n=this.viewH/2;e=f.clamp(e,r,this.w-r),i=f.clamp(i,n,this.h-n),this.view.x=r-e,this.view.y=n-i}},r.prototype.updateDieAnimations=function(){var t=this.cfg.configDieAnimation.base;for(var e in this.dieSprites){var i=this.dieSprites[e];i.alpha>t.alphaStart?i.alpha=t.alphaStart:i.alpha-=t.alphaDecrease,i.scale.x+=t.scaleIncrease,i.scale.y+=t.scaleIncrease,i.alpha<t.alphaEnd&&(i.parent&&i.parent.removeChild(i),this.dieSprites.splice(e,1))}},r.prototype.updateLogic=function(){h.prototype.updateLogic.call(this),this.updateDieAnimations()},r.prototype.start=function(){console.log("world start"),this.socket=n("ws://"+this.cfg.configApp.domain+":"+this.cfg.configApp.port),this.socket.on("connect",function(){console.log("connected to the server!")});var t=this;this.socket.on("pkg",function(e){t.dispatcher.onMessage(e)}),this.socket.on("disconnect",function(){console.log("client disconnected!")}),this.synchronizer.syncStartReq("test",this.viewW,this.viewH)},r.prototype.update=function(){h.prototype.update.call(this),this.updateCamera(),this.renderer.render(this.stage)},e.exports=r}()},{"../modules/cdispatcher":10,"../modules/synchronizer":18,"../modules/util":21,"../modules/world":24,protobufjs:74,"socket.io-client":51}],14:[function(t,e,i){!function(){"use strict";function i(t,e,i,o){this.world=t,this.type=r.unitType.hpbar,this.cfg=t.cfg.configHpbar[e],this.owner=i,this.display=o,this.percent=1,this.isDead=!1,this.view=new n(this),this.x=this.view.x,this.y=this.view.y,this.rotation=0}var r=t("../modules/util"),n=t("../modules/view");i.prototype={constructor:i},i.prototype.die=function(){this.view.onDie(),this.isDead=!0},i.prototype.update=function(t){this.isDead===!1&&(Math.abs(t-1)<1e-6&&this.display===!1?this.view.visible=!1:this.view.visible=!0,this.percent!=t&&(this.view.updateHpbar(this.percent,t),this.percent=t)),this.view.update()},Object.defineProperties(i.prototype,{}),e.exports=i}()},{"../modules/util":21,"../modules/view":22}],15:[function(t,e,i){!function(){"use strict";function i(t,e,i){this.owner=t,this.cfg=e,this.moveDir=new r(0,0),this.iv=new r(e.ivInit*Math.cos(i),e.ivInit*Math.sin(i)),this.ev=new r(0,0),this.rv=e.rv}var r=t("victor"),n=t("../modules/util"),o=1e-6;i.prototype={constructor:i},i.prototype.toString=function(){return"unit["+this.owner.id+"] move dir={"+this.moveDir.x+","+this.moveDir.y+"} iv={"+this.iv.x+","+this.iv.y+"} ev={"+this.ev.x+","+this.ev.y+"} v="+this.v},i.prototype.randomMoveDir=function(){var t=Math.random()*Math.PI*2;this.moveDir.x=Math.cos(t),this.moveDir.y=Math.sin(t)},i.prototype.setMoveDir=function(t,e){this.moveDir.x=t,this.moveDir.y=e},i.prototype.setMoveDirByAngle=function(t){this.moveDir.x=Math.cos(t),this.moveDir.y=Math.sin(t)},i.prototype.reverseIvX=function(){this.iv.x=-this.iv.x},i.prototype.reverseIvY=function(){this.iv.y=-this.iv.y},i.prototype.addRecoil=function(t,e){this.ev.x-=t*Math.cos(e),this.ev.y-=t*Math.sin(e)},i.prototype.update=function(t){var e,i,s,a;s=this.iv.length(),s>this.cfg.ivMin&&(i=this.cfg.ivDec*t/1e3,s=s>i?s-i:0,s=s<this.cfg.ivMin?this.cfg.ivMin:s,this.iv.norm().multiply(new r(s,s))),this.moveDir.length()>o&&(e=this.moveDir.angle(),this.iv.x+=this.cfg.ivAcc*Math.cos(e)*t/1e3,this.iv.y+=this.cfg.ivAcc*Math.sin(e)*t/1e3,s=this.iv.length(),s>this.cfg.ivMax&&(s=this.cfg.ivMax,this.iv.norm().multiply(new r(s,s)))),a=this.ev.length(),a>o&&(i=this.cfg.evDec*t/1e3,a=a>i?a-i:0,a=a>this.cfg.evMax?this.cfg.evMax:a,this.ev.norm().multiply(new r(a,a))),this.owner.x+=(this.iv.x+this.ev.x)*t/1e3,this.owner.y+=(this.iv.y+this.ev.y)*t/1e3,n.clampPosition(this.owner,0,this.owner.world.w,0,this.owner.world.h),null!==this.rv&&Math.abs(this.rv)>o&&(this.owner.rotation+=this.rv*t/1e3)},Object.defineProperties(i.prototype,{vx:{get:function(){return this.iv.x+this.ev.x}},vy:{get:function(){return this.iv.y+this.ev.y}},v:{get:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)}}}),e.exports=i}()},{"../modules/util":21,victor:45}],16:[function(t,e,i){!function(){"use strict";function i(t,e,i,o){r.call(this,t,n.unitType.obstacle,t.cfg.configObstacles[e],i,Math.random()*Math.PI*2,o),o===!0&&r.prototype.addHpBar.call(this,"base",!1)}var r=t("../modules/unit"),n=t("../modules/util");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.update=function(){r.prototype.update.call(this),(this.x<this.world.spawnRegion.x||this.x>this.world.spawnRegion.x+this.world.spawnRegion.w)&&this.motion.reverseIvX(),(this.y<this.world.spawnRegion.y||this.y>this.world.spawnRegion.y+this.world.spawnRegion.h)&&this.motion.reverseIvY()},e.exports=i}()},{"../modules/unit":20,"../modules/util":21}],17:[function(t,e,i){!function(){"use strict";function i(t,e,i,r,n){this.world=t,this.name=i,this.tank=null,this.connid=e,this.viewW=r,this.viewH=n,this.control=!1,this.controlDir={left:0,right:0,up:0,down:0},this.needSync=!1}var r=t("victor"),n=t("../modules/tank"),o=t("../modules/util");i.prototype={constructor:i},i.prototype.handleKeyDown=function(){var t=this;document.body.addEventListener("keydown",function(e){if(null!==t.tank)switch(e.keyCode){case 87:case 119:1!=t.controlDir.up&&(t.controlDir.up=1,t.needSync=!0);break;case 68:case 100:1!=t.controlDir.right&&(t.controlDir.right=1,t.needSync=!0);break;case 83:case 115:1!=t.controlDir.down&&(t.controlDir.down=1,t.needSync=!0);break;case 65:case 97:1!=t.controlDir.left&&(t.controlDir.left=1,t.needSync=!0)}},!1)},i.prototype.handleKeyUp=function(){var t=this;document.body.addEventListener("keyup",function(e){if(null!==t.tank)switch(e.keyCode){case 87:case 119:0!==t.controlDir.up&&(t.controlDir.up=0,t.needSync=!0);break;case 68:case 100:0!==t.controlDir.right&&(t.controlDir.right=0,t.needSync=!0);break;case 83:case 115:0!==t.controlDir.down&&(t.controlDir.down=0,t.needSync=!0);break;case 65:case 97:0!==t.controlDir.left&&(t.controlDir.left=0,t.needSync=!0)}},!1)},i.prototype.handleMouseMove=function(){var t=this;document.body.addEventListener("mousemove",function(e){var i=new r(e.offsetX-t.world.view.x,e.offsetY-t.world.view.y);if(null!==t.tank){var n=i.subtract(new r(t.tank.x,t.tank.y));t.tank.rotation=n.angle()+Math.PI/2,t.needSync=!0}},!1)},i.prototype.handleMouseDown=function(){var t=this;document.body.addEventListener("mousedown",function(){null!==t.tank&&(t.tank.revertFireStatus(),t.needSync=!0)},!1)},i.prototype.addControl=function(){this.control=!0,this.handleKeyDown(),this.handleKeyUp(),this.handleMouseMove(),this.handleMouseDown()},i.prototype.resetControl=function(){this.control=!1,this.controlDir.left=0,this.controlDir.right=0,this.controlDir.up=0,this.controlDir.down=0},i.prototype.createTank=function(){var t=(this.world.w-this.viewW)/2,e=(this.world.h-this.viewH)/2;this.tank=new n(this.world,"base",{x:Math.random()*t+this.viewW/2,y:Math.random()*e+this.viewH/2},this,!!this.world.view),this.tank.player=this,this.resetControl(),this.world.addUnit(this.tank)},i.prototype.bindTank=function(t){this.tank=t,t.player=this,this.resetControl()},i.prototype.update=function(){if(this.needSync===!0){if(this.control===!0){var t=o.getVectorByControlDir(this.controlDir);this.world.synchronizer.syncOperation(this,t)}else this.world.synchronizer.syncOperation(this);this.needSync=!1}},i.prototype.dump=function(){var t=new this.world.proto.Player;return t.connid=this.connid,t.name=this.name,t.vw=this.viewW,t.vh=this.viewH,this.tank?(t.id=this.tank.id,t.die=!1):t.die=!0,t},Object.defineProperties(i.prototype,{x:{get:function(){return this.tank?this.tank.x:0}},y:{get:function(){return this.tank?this.tank.y:0}}}),e.exports=i}()},{"../modules/tank":19,"../modules/util":21,victor:45}],18:[function(t,e,i){!function(){"use strict";function t(t){this.world=t,this.cmd=this.world.proto.SyncCmd,this.err=this.world.proto.ErrCode}t.prototype={constructor:t},t.prototype.sendPkg=function(t,e,i,r){var n=new this.world.proto.Pkg;switch(n.frame=this.world.frame,n.cmd=i,r&&(n.result=r),i){case this.cmd.SYNC_START_REQ:n.syncStartReq=e;break;case this.cmd.SYNC_START_RES:n.syncStartRes=e;break;case this.cmd.SYNC_UNITS:n.syncUnits=e;break;case this.cmd.SYNC_UNIT_DIE:n.syncUnitDie=e;break;case this.cmd.SYNC_PLAYER_JOIN:n.syncPlayerJoin=e;break;case this.cmd.SYNC_PLAYER_QUIT:n.syncPlayerQuit=e;break;case this.cmd.SYNC_COLLISION:n.syncCollision=e;break;case this.cmd.SYNC_OPERATION:n.syncOperation=e;break;default:return void console.log("invalid cmd="+i)}t.emit("pkg",n.encode().toArrayBuffer())},t.prototype.syncStartReq=function(t,e,i){var r=new this.world.proto.SyncStartReq;r.name=t,r.viewH=i,r.viewW=e,this.sendPkg(this.world.socket,r,this.cmd.SYNC_START_REQ)},t.prototype.syncStartRes=function(t,e,i,r){var n=new this.world.proto.SyncStartRes;n.connid=i,n.id=r?r:0,e==this.err.SUCCESS&&(n.units=[],this.world.dumpUnits(n.units),n.players=[],this.world.dumpPlayers(n.players)),this.sendPkg(t,n,this.cmd.SYNC_START_RES,e)},t.prototype.syncUnit=function(t){var e=new this.world.proto.SyncUnits;e.units=[],e.units.push(t.dump()),this.sendPkg(this.world.socket,e,this.cmd.SYNC_UNITS)},t.prototype.syncUnitDie=function(t){var e=new this.world.proto.SyncUnitDie;e.id=t.id,this.sendPkg(this.world.socket,e,this.cmd.SYNC_UNIT_DIE)},t.prototype.syncPlayerJoin=function(t){var e=new this.world.proto.SyncPlayerJoin;e.player=t.dump(),this.sendPkg(this.world.socket,e,this.cmd.SYNC_PLAYER_JOIN)},t.prototype.syncPlayerQuit=function(t){var e=new this.world.proto.SyncPlayerQuit;e.connid=t,this.sendPkg(this.world.socket,e,this.cmd.SYNC_PLAYER_QUIT)},t.prototype.syncCollision=function(t,e){var i=new this.world.proto.SyncCollision;i.u1=t.dump(),i.u2=e.dump(),this.sendPkg(this.world.socket,i,this.cmd.SYNC_COLLISION)},t.prototype.syncOperation=function(t,e){var i=new this.world.proto.SyncOperation;i.connid=t.connid,t.tank&&(i.fire=t.tank.autoFire,i.rotation=t.tank.rotation,e?(i.moveDirX=e.x,i.moveDirY=e.y):(i.moveDirX=t.tank.motion.moveDir.x,i.moveDirY=t.tank.motion.moveDir.y)),this.sendPkg(this.world.socket,i,this.cmd.SYNC_OPERATION)},e.exports=t}()},{}],19:[function(t,e,i){!function(){"use strict";function i(t,e,i,s,a,h){this.player=s,this.autoFire=!0,this.weapons=[];var f=t.cfg.configTanks[e];for(var l in f.weapons)if(""!==f.weapons[l]){var u=new r(t,this,f.weapons[l],a);this.weapons.push(u)}n.call(this,t,o.unitType.tank,f,i,0,a,h),a===!0&&n.prototype.addHpBar.call(this,"base",!0)}var r=t("../modules/weapon"),n=t("../modules/unit"),o=t("../modules/util");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){n.prototype.update.call(this),this.world.isLocal===!1&&this.autoFire===!0&&this.fire();for(var t in this.weapons)this.weapons[t].update()},i.prototype.getWeaponByName=function(t){for(var e in this.weapons)if(this.weapons[e].name===t)return this.weapons[e];return null},i.prototype.fire=function(){for(var t in this.weapons)this.weapons[t].fire()},i.prototype.revertFireStatus=function(){if(this.autoFire===!0)this.autoFire=!1;else{this.autoFire=!0;for(var t in this.weapons)this.weapons[t].resetFireDelay()}},e.exports=i}()},{"../modules/unit":20,"../modules/util":21,"../modules/weapon":23}],20:[function(t,e,i){!function(){"use strict";function i(t,e,i,r,o,h,f){this.world=t,this.world.isLocal===!1&&(this.id=++a),this.type=e,this.cfg=i,this.motion=new n(this,this.cfg.velocity,o),h===!0&&(this.view=new s(this,f)),this.x=r.x,this.y=r.y,this.rotation=0,this.hp=this.cfg.hp,this.damage=this.cfg.damage,this.isDead=!1}var r=t("../modules/hpbar"),n=t("../modules/motion"),o=t("../modules/util"),s=t("../modules/view"),a=0;i.prototype={constructor:i},i.prototype.addHpBar=function(t,e){this.hpbar&&delete this.hpbar,this.hpbar=new r(this.world,t,this,e)},i.prototype.outOfBounds=function(){return this.x<=0||this.x>=this.world.w||this.y<=0||this.y>=this.world.h},i.prototype.takeDamageByUnit=function(t){this.hp-=t.damage,this.hp<=0&&this.die()},i.prototype.die=function(){this.isDead=!0,this.hpbar&&this.hpbar.die(),this.view&&this.view.onDie(),this.world.removeUnit(this)},i.prototype.update=function(){var t=this.x,e=this.y,i=1e3/this.world.cfg.configWorld.frame;this.motion.update(i),this.world.updateUnitGrid(this,{x:t,y:e}),this.view&&this.view.update(),this.isDead===!1&&this.hpbar&&(this.hpbar.x+=this.x-t,this.hpbar.y+=this.y-e,this.hpbar.update(this.hp/this.cfg.hp))},i.prototype.dump=function(){var t=new this.world.proto.Unit;return t.id=this.id,t.type=this.type,t.cfgName=this.cfg.alias,t.hp=this.hp,t.ownerid=this.owner?this.owner.id:0,t.bornTime=this.bornTime?Math.floor(this.bornTime):0,t.weaponName=this.weaponName?this.weaponName:"",t.rotation=this.rotation,t.motion=new this.world.proto.Motion,t.motion.moveDir=new this.world.proto.Vector(this.motion.moveDir.x,this.motion.moveDir.y),t.motion.iv=new this.world.proto.Vector(this.motion.iv.x,this.motion.iv.y),t.motion.ev=new this.world.proto.Vector(this.motion.ev.x,this.motion.ev.y),t.motion.position=new this.world.proto.Vector(this.x,this.y),t},i.prototype.load=function(t){o.assert(this.id===t.id),o.assert(this.type===t.type),this.hp=t.hp,this.rotation=t.rotation,this.motion.iv.x=t.motion.iv.x,this.motion.iv.y=t.motion.iv.y,this.motion.ev.x=t.motion.ev.x,this.motion.ev.y=t.motion.ev.y,this.motion.moveDir.x=t.motion.moveDir.x,this.motion.moveDir.y=t.motion.moveDir.y;var e=this.x,i=this.y;this.x=t.motion.position.x,this.y=t.motion.position.y,this.hpbar&&(this.hpbar.x+=this.x-e,this.hpbar.y+=this.y-i,this.hpbar.update(this.hp/this.cfg.hp))},Object.defineProperties(i.prototype,{radius:{get:function(){return this.cfg.radius}},m:{get:function(){return this.radius*this.radius*this.cfg.density}}}),e.exports=i}()},{"../modules/hpbar":14,"../modules/motion":15,"../modules/util":21,"../modules/view":22}],21:[function(t,e,i){!function(){"use strict";var t={unitType:{tank:1,weapon:2,bullet:3,obstacle:4,hpbar:5},clamp:function(t,e,i){return t>i&&(t=i),t<e&&(t=e),t},clampPosition:function(t,e,i,r,n){t.x>i&&(t.x=i),t.x<e&&(t.x=e),t.y>n&&(t.y=n),t.y<r&&(t.y=r)},randomBetween:function(t,e){return Math.random()*(e-t)+t},assert:function(t,e){if(!t)throw Error("Assert failed"+("undefined"!=typeof e?": "+e:""))},getVectorByControlDir:function(t){var e=0,i=0;return 1==t.left&&(e-=1),1==t.right&&(e+=1),1==t.up&&(i-=1),1==t.down&&(i+=1),{x:e,y:i}}};e.exports=t}()},{}],22:[function(t,e,i){!function(){"use strict";function i(t){var e=new PIXI.Graphics;e.lineStyle(t.cfg.edge.w,t.cfg.edge.color);var i=t.world.getSelf();i.tank==t.owner.owner?e.beginFill(t.cfg.body.playerColor):e.beginFill(t.cfg.body.color),e.drawCircle(0,0,t.cfg.body.radius),e.endFill();var r=new PIXI.Sprite(e.generateTexture());e.destroy(),r.anchor.x=.5,r.anchor.y=.5,t.sprite.addChild(r),t.world.view.addChild(t.sprite)}function r(t){var e=new PIXI.Graphics;e.lineStyle(t.cfg.edge.w,t.cfg.edge.color),e.beginFill(t.cfg.color);var i=new PIXI.Point(0,-t.cfg.radius);e.moveTo(i.x,i.y);for(var r=1;r<t.cfg.side;++r){var n=new h(i.x,i.y);n.rotate(2*Math.PI/t.cfg.side),e.lineTo(n.x,n.y),i.set(n.x,n.y)}e.endFill();var o=new PIXI.Sprite(e.generateTexture());e.destroy(),o.pivot.x=o.width/2,o.pivot.y=t.cfg.radius+t.cfg.edge.w,t.sprite.addChild(o),t.world.view.addChild(t.sprite)}function n(t){var e=new PIXI.Graphics;e.lineStyle(t.cfg.edge.w,t.cfg.edge.color),e.beginFill(t.cfg.color),e.drawRect(0,0,t.cfg.w,t.cfg.h),e.endFill();var i=new PIXI.Sprite(e.generateTexture());e.destroy(),i.anchor.x=.5,i.anchor.y=1,t.sprite.addChild(i)}function o(t,e){for(var i in t.owner.weapons){var r=t.owner.weapons[i];t.sprite.addChild(r.view.sprite)}var n=new PIXI.Graphics;n.lineStyle(t.cfg.edge.w,t.cfg.edge.color),e===!0?n.beginFill(t.cfg.body.playerColor):n.beginFill(t.cfg.body.color),n.drawCircle(0,0,t.cfg.body.radius),n.endFill();var o=new PIXI.Sprite(n.generateTexture());n.destroy(),o.anchor.x=.5,o.anchor.y=.5,t.sprite.addChild(o),t.world.view.addChild(t.sprite)}function s(t){var e=new PIXI.Graphics;e.lineStyle(t.cfg.edge.w,t.cfg.edge.color),e.beginFill(t.cfg.edge.color),e.drawRoundedRect(0,0,t.cfg.w,t.cfg.h,t.cfg.radius),e.endFill(),t.backSprite=new PIXI.Sprite(e.generateTexture()),t.backSprite.anchor.x=.5,t.backSprite.anchor.y=.5,e.lineStyle(t.cfg.edge.w,t.cfg.edge.color),e.beginFill(t.cfg.color),e.drawRoundedRect(0,0,t.cfg.w,t.cfg.h,t.cfg.radius),e.endFill(),t.frontSprite=new PIXI.Sprite(e.generateTexture()),t.frontSprite.anchor.x=.5,t.frontSprite.anchor.y=.5,t.sprite.addChild(t.backSprite),t.sprite.addChild(t.frontSprite),t.sprite.alpha=t.cfg.alpha;var i=t.owner.owner,r=2*i.radius,n=i.cfg.view;t.sprite.x=i.x+i.radius*n.hpbar.xOffsetRatio,t.sprite.y=i.y+i.radius*n.hpbar.yOffsetRatio,t.sprite.scale.x=n.hpbar.scaleXRatio*r/t.cfg.w,t.sprite.scale.y=n.hpbar.scaleYRatio*r/t.cfg.w,t.world.view.addChild(t.sprite)}function a(t,e){this.owner=t,this.cfg=this.owner.cfg.view,this.world=this.owner.world,this.sprite=new PIXI.Container,this.owner.type==f.unitType.bullet?i(this):this.owner.type==f.unitType.obstacle?r(this):this.owner.type==f.unitType.weapon?n(this):this.owner.type==f.unitType.tank?o(this,e):this.owner.type==f.unitType.hpbar&&s(this)}var h=t("victor"),f=t("../modules/util");a.prototype={constructor:a},a.prototype.onDie=function(){this.owner.type!=f.unitType.bullet&&this.owner.type!=f.unitType.obstacle&&this.owner.type!=f.unitType.tank||this.world.dieSprites.push(this.sprite),this.owner.type==f.unitType.hpbar&&(this.sprite.parent&&this.sprite.parent.removeChild(this.sprite),delete this.sprite)},a.prototype.update=function(){this.x=this.owner.x,this.y=this.owner.y,this.rotation=this.owner.rotation},a.prototype.updateHpbar=function(t,e){this.owner.type==f.unitType.hpbar&&(this.frontSprite.x+=this.cfg.w*(1-t)/2,this.frontSprite.width=this.cfg.w*e,this.frontSprite.x-=this.cfg.w*(1-e)/2)},Object.defineProperties(a.prototype,{x:{get:function(){return this.sprite.x},set:function(t){this.sprite.x=t}},y:{get:function(){return this.sprite.y},set:function(t){this.sprite.y=t}},h:{get:function(){return this.sprite.height}},w:{get:function(){return this.sprite.width}},rotation:{get:function(){return this.sprite.rotation},set:function(t){this.sprite.rotation=t}},scale:{get:function(){return this.sprite.scale},set:function(t){this.sprite.scale=t}},visible:{get:function(){return this.sprite.visible},set:function(t){this.sprite.visible=t}}}),e.exports=a}()},{"../modules/util":21,victor:45}],23:[function(t,e,i){!function(){"use strict";function i(t,e,i,n){this.world=t,this.name=i,this.type=o.unitType.weapon,this.owner=e,this.cfg=t.cfg.configWeapons[i],this.fireFrame=t.frame+this.cfg.shootDelayFrame,n===!0&&(this.view=new s(this)),this.offset=new r(0,-this.cfg.shootOffset),this.offset.rotateDeg(this.cfg.angle).add(new r(this.cfg.x,this.cfg.y)),this.rotation=this.cfg.angle*Math.PI/180,this.x=this.cfg.x,this.y=this.cfg.y,this.fireAnimFrame=null,this.originalX=this.x,this.originalY=this.y}var r=t("victor"),n=t("../modules/bullet"),o=t("../modules/util"),s=t("../modules/view");i.prototype={constructor:i},i.prototype.resetFireDelay=function(){this.fireFrame=this.world.frame+this.cfg.shootDelayFrame},i.prototype.update=function(){if(this.fireAnimFrame){var t=this.world.frame-this.fireAnimFrame;if(t>this.cfg.fireAnimFrame)this.fireAnimFrame=null;else{var e=Math.abs(t/this.cfg.fireAnimFrame*2-1)*this.cfg.fireAnimDistance;this.x=this.originalX+Math.cos(this.rotation+Math.PI/2)*e,this.y=this.originalY+Math.sin(this.rotation+Math.PI/2)*e}}this.view&&this.view.update()},i.prototype.fireBullet=function(t){this.fireFrame=this.world.frame,this.fireAnimFrame=this.world.frame},i.prototype.fire=function(){if(this.world.frame-this.fireFrame>=this.cfg.reloadFrame){this.fireFrame=this.world.frame,this.fireAnimFrame=this.world.frame;var t=this.offset.clone();if(t.rotate(this.owner.rotation),t.add(new r(this.owner.x,this.owner.y)),t.x<=0||t.y<=0||t.x>=this.world.w||t.y>=this.world.h)return;var e=this.owner.rotation+this.cfg.angle*Math.PI/180-Math.PI/2,i=this.cfg.disturbDeg*Math.PI/180,o=e+(Math.random()*i-i/2),s=new n(this.world,this.cfg.bullet,t,o,this.owner,this.name,!!this.view);this.world.addUnit(s);var a=this.cfg.recoil/this.owner.m;this.owner.motion.addRecoil(a,e)}},e.exports=i}()},{"../modules/bullet":9,"../modules/util":21,"../modules/view":22,victor:45}],24:[function(t,e,i){!function(){"use strict";function i(){this.frame=0,this.cfg=new r,this.w=this.cfg.configMap.w,this.h=this.cfg.configMap.h,this.spawnRegion={},this.spawnRegion.x=this.w*(1-this.cfg.configMap.obstacleRegion.wRatio)/2,this.spawnRegion.w=this.w*this.cfg.configMap.obstacleRegion.wRatio,this.spawnRegion.y=this.h*(1-this.cfg.configMap.obstacleRegion.hRatio)/2,
this.spawnRegion.h=this.h*this.cfg.configMap.obstacleRegion.hRatio,this.gridSize=this.cfg.configWorld.gridSize,this.gridW=Math.floor(this.w/this.gridSize)+1,this.gridH=Math.floor(this.h/this.gridSize)+1,this.grids=[];for(var t=0;t<this.gridH;++t)for(var e=0;e<this.gridW;++e)this.grids.push({});var i=new Date;this.time=i.getTime(),this.bullets={},this.obstacles={},this.obstacleCount=0,this.tanks={},this.players={},this.playerCount=0,this.unitsToAdd=[],this.unitsToRemove=[]}var r=t("../modules/config"),n=t("../modules/player"),o=t("../modules/util");i.prototype={constructor:i},i.prototype.addPlayer=function(t,e,i,r){var o=new n(this,t,e,i,r);return this.players[t]=o,this.playerCount++,console.log("add player:"+t),o},i.prototype.removePlayer=function(t){var e=this.players[t];e&&(delete this.players[t],--this.playerCount,console.log("remove player:"+t),e.tank&&(e.tank.player=null,e.tank.die()))},i.prototype.dumpPlayers=function(t){for(var e in this.players)t.push(this.players[e].dump())},i.prototype.addUnit=function(t){this.unitsToAdd.push(t)},i.prototype.removeUnit=function(t){this.unitsToRemove.push(t)},i.prototype.findUnit=function(t){if(this.bullets[t])return this.bullets[t];if(this.obstacles[t])return this.obstacles[t];if(this.tanks[t])return this.tanks[t];for(var e in this.unitsToAdd)if(this.unitsToAdd[e].id==t)return this.unitsToAdd[e];return null},i.prototype.checkAddUnits=function(){for(var t in this.unitsToAdd){var e=this.unitsToAdd[t];this.updateUnitGrid(e),e.type==o.unitType.bullet&&(this.bullets[e.id]=e,console.log("add bullet:"+e.id)),e.type==o.unitType.obstacle&&(this.obstacles[e.id]=e,this.obstacleCount++,console.log("add obstacle:"+e.id)),e.type==o.unitType.tank&&(this.tanks[e.id]=e,console.log("add tank:"+e.id))}this.unitsToAdd=[]},i.prototype.checkRemoveUnits=function(){for(var t in this.unitsToRemove){var e=this.unitsToRemove[t];this.removeUnitFromGrid(e),e.type==o.unitType.bullet&&(delete this.bullets[e.id],console.log("remove bullet:"+e.id)),e.type==o.unitType.obstacle&&(delete this.obstacles[e.id],--this.obstacleCount,console.log("remove obstacle:"+e.id)),e.type==o.unitType.tank&&(delete this.tanks[e.id],console.log("remove tank:"+e.id),e.player&&(e.player.tank=null))}this.unitsToRemove=[]},i.prototype.dumpUnits=function(t){var e;for(e in this.bullets)t.push(this.bullets[e].dump());for(e in this.obstacles)t.push(this.obstacles[e].dump());for(e in this.tanks)t.push(this.tanks[e].dump());for(e in this.unitsToAdd)t.push(this.unitsToAdd[e].dump())},i.prototype.updatePlayers=function(){for(var t in this.players){var e=this.players[t];e.update()}},i.prototype.updateTanks=function(){for(var t in this.tanks){var e=this.tanks[t];e.update()}},i.prototype.updateObstacles=function(){for(var t in this.obstacles){var e=this.obstacles[t],i=e.x,r=e.y;e.update(),this.updateUnitGrid(e,{x:i,y:r})}},i.prototype.updateBullets=function(){for(var t in this.bullets){var e=this.bullets[t],i=e.x,r=e.y;e.update(),this.updateUnitGrid(e,{x:i,y:r})}},i.prototype.updateUnitGrid=function(t,e){if(!e||e.x!=t.x||e.y!=t.y){var i=null;if(e){var r=Math.floor(e.x/this.gridSize),n=Math.floor(e.y/this.gridSize);i=n*this.gridW+r}var o=Math.floor(t.x/this.gridSize),s=Math.floor(t.y/this.gridSize),a=s*this.gridW+o;i&&a!=i&&delete this.grids[i][t.id],this.grids[a][t.id]=t}},i.prototype.removeUnitFromGrid=function(t){var e=Math.floor(t.x/this.gridSize),i=Math.floor(t.y/this.gridSize),r=i*this.gridW+e;delete this.grids[r][t.id]},i.prototype.updateLogic=function(){this.checkRemoveUnits(),this.checkAddUnits(),this.updatePlayers(),this.updateTanks(),this.updateObstacles(),this.updateBullets()},i.prototype.update=function(){for(var t=new Date,e=t.getTime(),i=1e3/this.cfg.configWorld.frame;e>this.time+i;)this.time+=i,this.frame++,this.updateLogic()},e.exports=i}()},{"../modules/config":12,"../modules/player":17,"../modules/util":21}],25:[function(t,e,i){var r=[].indexOf;e.exports=function(t,e){if(r)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},{}],26:[function(t,e,i){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],27:[function(t,e,i){(function(t){var i=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):i.test(e.replace(r,"@").replace(n,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,i){i.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},i.decode=function(t){for(var e={},i=t.split("&"),r=0,n=i.length;r<n;r++){var o=i[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},{}],29:[function(t,e,i){e.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],30:[function(t,e,i){(function(t){function i(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.buffer instanceof ArrayBuffer){var r=i.buffer;if(i.byteLength!==r.byteLength){var n=new Uint8Array(i.byteLength);n.set(new Uint8Array(r,i.byteOffset,i.byteLength)),r=n.buffer}t[e]=r}}}function r(t,e){e=e||{};var r=new o;i(t);for(var n=0;n<t.length;n++)r.append(t[n]);return e.type?r.getBlob(e.type):r.getBlob()}function n(t,e){return i(t),new Blob(t,e||{})}var o=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size}catch(t){return!1}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size}catch(t){return!1}}(),h=o&&o.prototype.append&&o.prototype.getBlob;e.exports=function(){return s?a?t.Blob:n:h?r:void 0}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,e,i){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,i=t.indexOf("["),o=t.indexOf("]");i!=-1&&o!=-1&&(t=t.substring(0,i)+t.substring(i,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=r.exec(t||""),a={},h=14;h--;)a[n[h]]=s[h]||"";return i!=-1&&o!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],32:[function(t,e,i){e.exports=function(t,e,i){var r=t.byteLength;if(e=e||0,i=i||r,t.slice)return t.slice(e,i);if(e<0&&(e+=r),i<0&&(i+=r),i>r&&(i=r),e>=r||e>=i||0===r)return new ArrayBuffer(0);for(var n=new Uint8Array(t),o=new Uint8Array(i-e),s=e,a=0;s<i;s++,a++)o[a]=n[s];return o.buffer}},{}],33:[function(t,e,i){"use strict";function r(t){var e="";do e=a[t%h]+e,t=Math.floor(t/h);while(t>0);return e}function n(t){var e=0;for(u=0;u<t.length;u++)e=e*h+f[t.charAt(u)];return e}function o(){var t=r(+new Date);return t!==s?(l=0,s=t):t+"."+r(l++)}for(var s,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),h=64,f={},l=0,u=0;u<h;u++)f[a[u]]=u;o.encode=r,o.decode=n,e.exports=o},{}],34:[function(t,e,i){function r(t,e){var i=[];e=e||0;for(var r=e||0;r<t.length;r++)i[r-e]=t[r];return i}e.exports=r},{}],35:[function(t,e,i){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),r=0;r<t.length;r++)e[t.charCodeAt(r)]=r;i.encode=function(e){var i,r=new Uint8Array(e),n=r.length,o="";for(i=0;i<n;i+=3)o+=t[r[i]>>2],o+=t[(3&r[i])<<4|r[i+1]>>4],o+=t[(15&r[i+1])<<2|r[i+2]>>6],o+=t[63&r[i+2]];return n%3===2?o=o.substring(0,o.length-1)+"=":n%3===1&&(o=o.substring(0,o.length-2)+"=="),o},i.decode=function(t){var i,r,n,o,s,a=.75*t.length,h=t.length,f=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var l=new ArrayBuffer(a),u=new Uint8Array(l);for(i=0;i<h;i+=4)r=e[t.charCodeAt(i)],n=e[t.charCodeAt(i+1)],o=e[t.charCodeAt(i+2)],s=e[t.charCodeAt(i+3)],u[f++]=r<<2|n>>4,u[f++]=(15&n)<<4|o>>2,u[f++]=(3&o)<<6|63&s;return l}}()},{}],36:[function(t,e,i){(function(i){function r(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(n(t)){for(var r=0;r<t.length;r++)if(e(t[r]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0}return!1}return e(t)}var n=t("isarray");e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:26}],37:[function(t,e,i){(function(i){function r(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(n(t)){for(var r=0;r<t.length;r++)if(e(t[r]))return!0}else if(t&&"object"==typeof t){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0}return!1}return e(t)}var n=t("isarray");e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:26}],38:[function(t,e,i){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function s(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}function a(){g&&d&&(g=!1,d.length?y=d.concat(y):v=-1,y.length&&h())}function h(){if(!g){var t=o(a);g=!0;for(var e=y.length;e;){for(d=y,y=[];++v<e;)d&&d[v].run();v=-1,e=y.length}d=null,g=!1,s(t)}}function f(t,e){this.fun=t,this.array=e}function l(){}var u,c,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(t){u=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var d,y=[],g=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];y.push(new f(t,e)),1!==y.length||g||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],39:[function(t,e,i){function r(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return i*u;case"days":case"day":case"d":return i*l;case"hours":case"hour":case"hrs":case"hr":case"h":return i*f;case"minutes":case"minute":case"mins":case"min":case"m":return i*h;case"seconds":case"second":case"secs":case"sec":case"s":return i*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i}}}}function n(t){return t>=l?Math.round(t/l)+"d":t>=f?Math.round(t/f)+"h":t>=h?Math.round(t/h)+"m":t>=a?Math.round(t/a)+"s":t+"ms"}function o(t){return s(t,l,"day")||s(t,f,"hour")||s(t,h,"minute")||s(t,a,"second")||t+" ms"}function s(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var a=1e3,h=60*a,f=60*h,l=24*f,u=365.25*l;e.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e.long?o(t):n(t)}},{}],40:[function(t,e,i){function r(t,e,i){function r(t,n){if(r.count<=0)throw new Error("after called too many times");--r.count,t?(o=!0,e(t),e=i):0!==r.count||o||e(null,n)}var o=!1;return i=i||n,r.count=t,0===t?e():r}function n(){}e.exports=r},{}],41:[function(t,e,i){var r=[].slice;e.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}}},{}],42:[function(t,e,i){(function(t){!function(r){function n(t){for(var e,i,r=[],n=0,o=t.length;n<o;)e=t.charCodeAt(n++),e>=55296&&e<=56319&&n<o?(i=t.charCodeAt(n++),56320==(64512&i)?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--)):r.push(e);return r}function o(t){for(var e,i=t.length,r=-1,n="";++r<i;)e=t[r],e>65535&&(e-=65536,n+=m(e>>>10&1023|55296),e=56320|1023&e),n+=m(e);return n}function s(t,e){return m(t>>e&63|128)}function a(t){if(0==(4294967168&t))return m(t);var e="";return 0==(4294965248&t)?e=m(t>>6&31|192):0==(4294901760&t)?(e=m(t>>12&15|224),e+=s(t,6)):0==(4292870144&t)&&(e=m(t>>18&7|240),e+=s(t,12),e+=s(t,6)),e+=m(63&t|128)}function h(t){for(var e,i=n(t),r=i.length,o=-1,s="";++o<r;)e=i[o],s+=a(e);return s}function f(){if(v>=g)throw Error("Invalid byte index");var t=255&y[v];if(v++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(){var t,e,i,r,n;if(v>g)throw Error("Invalid byte index");if(v==g)return!1;if(t=255&y[v],v++,0==(128&t))return t;if(192==(224&t)){var e=f();if(n=(31&t)<<6|e,n>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if(e=f(),i=f(),n=(15&t)<<12|e<<6|i,n>=2048)return n;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=f(),i=f(),r=f(),n=(15&t)<<18|e<<12|i<<6|r,n>=65536&&n<=1114111))return n;throw Error("Invalid WTF-8 detected")}function u(t){y=n(t),g=y.length,v=0;for(var e,i=[];(e=l())!==!1;)i.push(e);return o(i)}var c="object"==typeof i&&i,p="object"==typeof e&&e&&e.exports==c&&e,d="object"==typeof t&&t;d.global!==d&&d.window!==d||(r=d);var y,g,v,m=String.fromCharCode,w={version:"1.0.0",encode:h,decode:u};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return w});else if(c&&!c.nodeType)if(p)p.exports=w;else{var b={},E=b.hasOwnProperty;for(var T in w)E.call(w,T)&&(c[T]=w[T])}else r.wtf8=w}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],43:[function(t,e,i){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}},{}],44:[function(t,e,i){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},{}],45:[function(t,e,i){function r(t,e){return this instanceof r?(this.x=t||0,void(this.y=e||0)):new r(t,e)}function n(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function o(t){return t*a}function s(t){return t/a}i=e.exports=r,r.fromArray=function(t){return new r(t[0]||0,t[1]||0)},r.fromObject=function(t){return new r(t.x||0,t.y||0)},r.prototype.addX=function(t){return this.x+=t.x,this},r.prototype.addY=function(t){return this.y+=t.y,this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},r.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},r.prototype.addScalarX=function(t){return this.x+=t,this},r.prototype.addScalarY=function(t){return this.y+=t,this},r.prototype.subtractX=function(t){return this.x-=t.x,this},r.prototype.subtractY=function(t){return this.y-=t.y,this},r.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},r.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},r.prototype.subtractScalarX=function(t){return this.x-=t,this},r.prototype.subtractScalarY=function(t){return this.y-=t,this},r.prototype.divideX=function(t){return this.x/=t.x,this},r.prototype.divideY=function(t){return this.y/=t.y,this},r.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},r.prototype.divideScalar=function(t){return 0!==t?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},r.prototype.divideScalarX=function(t){return 0!==t?this.x/=t:this.x=0,this},r.prototype.divideScalarY=function(t){return 0!==t?this.y/=t:this.y=0,this},r.prototype.invertX=function(){return this.x*=-1,this},r.prototype.invertY=function(){return this.y*=-1,this},r.prototype.invert=function(){return this.invertX(),this.invertY(),this},r.prototype.multiplyX=function(t){return this.x*=t.x,this},r.prototype.multiplyY=function(t){return this.y*=t.y,this},r.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},r.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},r.prototype.multiplyScalarX=function(t){return this.x*=t,this},r.prototype.multiplyScalarY=function(t){return this.y*=t,this},r.prototype.normalize=function(){var t=this.length();return 0===t?(this.x=1,this.y=0):this.divide(r(t,t)),this},r.prototype.norm=r.prototype.normalize,r.prototype.limit=function(t,e){return Math.abs(this.x)>t&&(this.x*=e),Math.abs(this.y)>t&&(this.y*=e),this},r.prototype.randomize=function(t,e){return this.randomizeX(t,e),this.randomizeY(t,e),this},r.prototype.randomizeX=function(t,e){var i=Math.min(t.x,e.x),r=Math.max(t.x,e.x);return this.x=n(i,r),this},r.prototype.randomizeY=function(t,e){var i=Math.min(t.y,e.y),r=Math.max(t.y,e.y);return this.y=n(i,r),this},r.prototype.randomizeAny=function(t,e){return Math.round(Math.random())?this.randomizeX(t,e):this.randomizeY(t,e),this},r.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},r.prototype.toFixed=function(t){return"undefined"==typeof t&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},r.prototype.mixX=function(t,e){return"undefined"==typeof e&&(e=.5),this.x=(1-e)*this.x+e*t.x,this},r.prototype.mixY=function(t,e){return"undefined"==typeof e&&(e=.5),this.y=(1-e)*this.y+e*t.y,this},r.prototype.mix=function(t,e){return this.mixX(t,e),this.mixY(t,e),this},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyX=function(t){return this.x=t.x,this},r.prototype.copyY=function(t){return this.y=t.y,this},r.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},r.prototype.zero=function(){return this.x=this.y=0,this},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y},r.prototype.cross=function(t){return this.x*t.y-this.y*t.x},r.prototype.projectOnto=function(t){var e=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=e*t.x,this.y=e*t.y,this},r.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},r.prototype.horizontalAngleDeg=function(){return o(this.horizontalAngle())},r.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},r.prototype.verticalAngleDeg=function(){return o(this.verticalAngle())},r.prototype.angle=r.prototype.horizontalAngle,r.prototype.angleDeg=r.prototype.horizontalAngleDeg,r.prototype.direction=r.prototype.horizontalAngle,r.prototype.rotate=function(t){var e=this.x*Math.cos(t)-this.y*Math.sin(t),i=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=i,this},r.prototype.rotateDeg=function(t){return t=s(t),this.rotate(t)},r.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},r.prototype.rotateToDeg=function(t){return t=s(t),this.rotateTo(t)},r.prototype.rotateBy=function(t){var e=this.angle()+t;return this.rotate(e)},r.prototype.rotateByDeg=function(t){return t=s(t),this.rotateBy(t)},r.prototype.distanceX=function(t){return this.x-t.x},r.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},r.prototype.distanceY=function(t){return this.y-t.y},r.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},r.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},r.prototype.distanceSq=function(t){var e=this.distanceX(t),i=this.distanceY(t);return e*e+i*i},r.prototype.length=function(){return Math.sqrt(this.lengthSq())},r.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},r.prototype.magnitude=r.prototype.length,r.prototype.isZero=function(){return 0===this.x&&0===this.y},r.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},r.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},r.prototype.toArray=function(){return[this.x,this.y]},r.prototype.toObject=function(){return{x:this.x,y:this.y}};var a=180/Math.PI},{}],46:[function(t,e,i){function r(t){if(t)return n(t)}function n(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},r.prototype.once=function(t,e){function i(){r.off(t,i),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[t];if(!i)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,n=0;n<i.length;n++)if(r=i[n],r===e||r.fn===e){i.splice(n,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks[t];if(i){i=i.slice(0);for(var r=0,n=i.length;r<n;++r)i[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],47:[function(t,e,i){},{}],48:[function(t,e,i){function r(t){if(t)return n(t)}function n(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,n=0;n<i.length;n++)if(r=i[n],r===e||r.fn===e){i.splice(n,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i){i=i.slice(0);for(var r=0,n=i.length;r<n;++r)i[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],49:[function(t,e,i){(function(e){function r(t,e){var r="b"+i.packets[t.type]+t.data.data;return e(r)}function n(t,e,r){if(!e)return i.encodeBase64Packet(t,r);var n=t.data,o=new Uint8Array(n),s=new Uint8Array(1+n.byteLength);s[0]=m[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}function o(t,e,r){if(!e)return i.encodeBase64Packet(t,r);var n=new FileReader;return n.onload=function(){t.data=n.result,i.encodePacket(t,e,!0,r)},n.readAsArrayBuffer(t.data)}function s(t,e,r){if(!e)return i.encodeBase64Packet(t,r);if(v)return o(t,e,r);var n=new Uint8Array(1);n[0]=m[t.type];var s=new E([n.buffer,t.data]);return r(s)}function a(t){try{t=d.decode(t)}catch(t){return!1}return t}function h(t,e,i){for(var r=new Array(t.length),n=p(t.length,i),o=function(t,i,n){e(i,function(e,i){r[t]=i,n(e,r)})},s=0;s<t.length;s++)o(s,t[s],n)}var f,l=t("./keys"),u=t("has-binary"),c=t("arraybuffer.slice"),p=t("after"),d=t("wtf-8");e&&e.ArrayBuffer&&(f=t("base64-arraybuffer"));var y="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=y||g;i.protocol=3;var m=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},w=l(m),b={type:"error",data:"parser error"},E=t("blob");i.encodePacket=function(t,i,o,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof o&&(a=o,o=null);var h=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&h instanceof ArrayBuffer)return n(t,i,a);if(E&&h instanceof e.Blob)return s(t,i,a);if(h&&h.base64)return r(t,a);var f=m[t.type];return void 0!==t.data&&(f+=o?d.encode(String(t.data)):String(t.data)),a(""+f)},i.encodeBase64Packet=function(t,r){var n="b"+i.packets[t.type];if(E&&t.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];r(n+t)},o.readAsDataURL(t.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var a=new Uint8Array(t.data),h=new Array(a.length),f=0;f<a.length;f++)h[f]=a[f];s=String.fromCharCode.apply(null,h)}return n+=e.btoa(s),r(n)},i.decodePacket=function(t,e,r){if(void 0===t)return b;if("string"==typeof t){if("b"==t.charAt(0))return i.decodeBase64Packet(t.substr(1),e);if(r&&(t=a(t),t===!1))return b;var n=t.charAt(0);return Number(n)==n&&w[n]?t.length>1?{type:w[n],data:t.substring(1)}:{type:w[n]}:b}var o=new Uint8Array(t),n=o[0],s=c(t,1);return E&&"blob"===e&&(s=new E([s])),{type:w[n],data:s}},i.decodeBase64Packet=function(t,e){var i=w[t.charAt(0)];if(!f)return{type:i,data:{base64:!0,data:t.substr(1)}};var r=f.decode(t.substr(1));return"blob"===e&&E&&(r=new E([r])),{type:i,data:r}},i.encodePayload=function(t,e,r){function n(t){return t.length+":"+t}function o(t,r){i.encodePacket(t,!!s&&e,!0,function(t){r(null,n(t))})}"function"==typeof e&&(r=e,e=null);var s=u(t);return e&&s?E&&!v?i.encodePayloadAsBlob(t,r):i.encodePayloadAsArrayBuffer(t,r):t.length?void h(t,o,function(t,e){return r(e.join(""))}):r("0:")},i.decodePayload=function(t,e,r){if("string"!=typeof t)return i.decodePayloadAsBinary(t,e,r);"function"==typeof e&&(r=e,e=null);var n;if(""==t)return r(b,0,1);for(var o,s,a="",h=0,f=t.length;h<f;h++){var l=t.charAt(h);if(":"!=l)a+=l;else{if(""==a||a!=(o=Number(a)))return r(b,0,1);if(s=t.substr(h+1,o),a!=s.length)return r(b,0,1);if(s.length){if(n=i.decodePacket(s,e,!0),b.type==n.type&&b.data==n.data)return r(b,0,1);var u=r(n,h+o,f);if(!1===u)return}h+=o,a=""}}return""!=a?r(b,0,1):void 0},i.encodePayloadAsArrayBuffer=function(t,e){function r(t,e){i.encodePacket(t,!0,!0,function(t){return e(null,t)})}return t.length?void h(t,r,function(t,i){var r=i.reduce(function(t,e){var i;return i="string"==typeof e?e.length:e.byteLength,t+i.toString().length+i+2},0),n=new Uint8Array(r),o=0;return i.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);i=r.buffer}e?n[o++]=0:n[o++]=1;for(var a=i.byteLength.toString(),s=0;s<a.length;s++)n[o++]=parseInt(a[s]);n[o++]=255;for(var r=new Uint8Array(i),s=0;s<r.length;s++)n[o++]=r[s]}),e(n.buffer)}):e(new ArrayBuffer(0))},i.encodePayloadAsBlob=function(t,e){function r(t,e){i.encodePacket(t,!0,!0,function(t){var i=new Uint8Array(1);if(i[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);t=r.buffer,i[0]=0}for(var o=t instanceof ArrayBuffer?t.byteLength:t.size,s=o.toString(),a=new Uint8Array(s.length+1),n=0;n<s.length;n++)a[n]=parseInt(s[n]);if(a[s.length]=255,E){var h=new E([i.buffer,a.buffer,t]);e(null,h)}})}h(t,r,function(t,i){return e(new E(i))})},i.decodePayloadAsBinary=function(t,e,r){"function"==typeof e&&(r=e,e=null);for(var n=t,o=[],s=!1;n.byteLength>0;){for(var a=new Uint8Array(n),h=0===a[0],f="",l=1;255!=a[l];l++){if(f.length>310){s=!0;break}f+=a[l]}if(s)return r(b,0,1);n=c(n,2+f.length),f=parseInt(f);var u=c(n,0,f);if(h)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(t){var p=new Uint8Array(u);u="";for(var l=0;l<p.length;l++)u+=String.fromCharCode(p[l])}o.push(u),n=c(n,f)}var d=o.length;o.forEach(function(t,n){r(i.decodePacket(t,e,!0),n,d)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":50,after:40,"arraybuffer.slice":32,"base64-arraybuffer":35,blob:30,"has-binary":36,"wtf-8":42}],50:[function(t,e,i){e.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var r in t)i.call(t,r)&&e.push(r);return e}},{}],51:[function(t,e,i){function r(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r=o(t),s=r.source,l=r.id,u=r.path,c=f[l]&&u in f[l].nsps,p=e.forceNew||e["force new connection"]||!1===e.multiplex||c;return p?(h("ignoring socket cache for %s",s),i=a(s,e)):(f[l]||(h("new io instance for %s",s),f[l]=a(s,e)),i=f[l]),r.query&&!e.query?e.query=r.query:e&&"object"==typeof e.query&&(e.query=n(e.query)),i.socket(r.path,e)}function n(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")}var o=t("./url"),s=t("socket.io-parser"),a=t("./manager"),h=t("debug")("socket.io-client");e.exports=i=r;var f=i.managers={};i.protocol=s.protocol,i.connect=r,i.Manager=t("./manager"),i.Socket=t("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:66,"socket.io-parser":69}],52:[function(t,e,i){function r(t,e){return this instanceof r?(t&&"object"==typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new c({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(t,e)}var n=t("engine.io-client"),o=t("./socket"),s=t("component-emitter"),a=t("socket.io-parser"),h=t("./on"),f=t("component-bind"),l=t("debug")("socket.io-client:manager"),u=t("indexof"),c=t("backo2"),p=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)p.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},r.prototype.updateSocketIds=function(){for(var t in this.nsps)p.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},s(r.prototype),r.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},r.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(t){
return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},r.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(t,e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=n(this.uri,this.opts);var i=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=h(i,"open",function(){r.onopen(),t&&t()}),s=h(i,"error",function(e){if(l("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;l("connect attempt will timeout after %d",a);var f=setTimeout(function(){l("connect attempt timed out after %d",a),o.destroy(),i.close(),i.emit("error","timeout"),r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(f)}})}return this.subs.push(o),this.subs.push(s),this},r.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(h(t,"data",f(this,"ondata"))),this.subs.push(h(t,"ping",f(this,"onping"))),this.subs.push(h(t,"pong",f(this,"onpong"))),this.subs.push(h(t,"error",f(this,"onerror"))),this.subs.push(h(t,"close",f(this,"onclose"))),this.subs.push(h(this.decoder,"decoded",f(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(t){this.decoder.add(t)},r.prototype.ondecoded=function(t){this.emit("packet",t)},r.prototype.onerror=function(t){l("error",t),this.emitAll("error",t)},r.prototype.socket=function(t,e){function i(){~u(n.connecting,r)||n.connecting.push(r)}var r=this.nsps[t];if(!r){r=new o(this,t,e),this.nsps[t]=r;var n=this;r.on("connecting",i),r.on("connect",function(){r.id=n.engine.id}),this.autoConnect&&i()}return r},r.prototype.destroy=function(t){var e=u(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},r.prototype.packet=function(t){l("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var r=0;r<i.length;r++)e.engine.write(i[r],t.options);e.encoding=!1,e.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},r.prototype.cleanup=function(){l("cleanup");for(var t=this.subs.length,e=0;e<t;e++){var i=this.subs.shift();i.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(t){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();l("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(l("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(l("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(l("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},r.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"./on":53,"./socket":54,backo2:43,"component-bind":41,"component-emitter":48,debug:66,"engine.io-client":56,indexof:25,"socket.io-parser":69}],53:[function(t,e,i){function r(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}e.exports=r},{}],54:[function(t,e,i){function r(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var n=t("socket.io-parser"),o=t("component-emitter"),s=t("to-array"),a=t("./on"),h=t("component-bind"),f=t("debug")("socket.io-client:socket"),l=t("has-binary");e.exports=i=r;var u={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},c=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",h(this,"onopen")),a(t,"packet",h(this,"onpacket")),a(t,"close",h(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},r.prototype.emit=function(t){if(u.hasOwnProperty(t))return c.apply(this,arguments),this;var e=s(arguments),i=n.EVENT;l(e)&&(i=n.BINARY_EVENT);var r={type:i,data:e};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(f("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},r.prototype.onopen=function(){f("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:n.CONNECT,query:this.query}):this.packet({type:n.CONNECT}))},r.prototype.onclose=function(t){f("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},r.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case n.CONNECT:this.onconnect();break;case n.EVENT:this.onevent(t);break;case n.BINARY_EVENT:this.onevent(t);break;case n.ACK:this.onack(t);break;case n.BINARY_ACK:this.onack(t);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",t.data)}},r.prototype.onevent=function(t){var e=t.data||[];f("emitting event %j",e),null!=t.id&&(f("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?c.apply(this,e):this.receiveBuffer.push(e)},r.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var r=s(arguments);f("sending ack %j",r);var o=l(r)?n.BINARY_ACK:n.ACK;e.packet({type:o,id:t,data:r})}}},r.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(f("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):f("bad ack %s",t.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)c.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){f("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(f("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},{"./on":53,"component-bind":41,"component-emitter":48,debug:66,"has-binary":37,"socket.io-parser":69,"to-array":34}],55:[function(t,e,i){(function(i){function r(t,e){var r=t;e=e||i.location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(o("protocol-less url %s",t),t="undefined"!=typeof e?e.protocol+"//"+t:"https://"+t),o("parse %s",t),r=n(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=r.host.indexOf(":")!==-1,a=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port,r.href=r.protocol+"://"+a+(e&&e.port===r.port?"":":"+r.port),r}var n=t("parseuri"),o=t("debug")("socket.io-client:url");e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:66,parseuri:31}],56:[function(t,e,i){e.exports=t("./lib/index")},{"./lib/index":57}],57:[function(t,e,i){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":58,"engine.io-parser":49}],58:[function(t,e,i){(function(i){function r(t,e){if(!(this instanceof r))return new r(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=l(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=l(e.host).host),this.secure=null!=e.secure?e.secure:i.location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(i.location?location.hostname:"localhost"),this.port=e.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized?null:e.rejectUnauthorized;var n="object"==typeof i&&i;n.global===n&&e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function n(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var o=t("./transports/index"),s=t("component-emitter"),a=t("debug")("engine.io-client:socket"),h=t("indexof"),f=t("engine.io-parser"),l=t("parseuri"),u=t("parsejson"),c=t("parseqs");e.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=f.protocol,r.Socket=r,r.Transport=t("./transport"),r.transports=t("./transports/index"),r.parser=t("engine.io-parser"),r.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=n(this.query);e.EIO=f.protocol,e.transport=t,this.id&&(e.sid=this.id);var i=new o[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return i},r.prototype.open=function(){var t;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},r.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},r.prototype.probe=function(t){function e(){if(c.onlyBinaryUpgrades){var e=!this.supportsBinary&&c.transport.supportsBinary;u=u||e}u||(a('probe transport "%s" opened',t),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(e){if(!u)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),c.upgrading=!0,c.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"===l.name,a('pausing current transport "%s"',c.transport.name),c.transport.pause(function(){u||"closed"!==c.readyState&&(a("changing transport and sending upgrade packet"),f(),c.setTransport(l),l.send([{type:"upgrade"}]),c.emit("upgrade",l),l=null,c.upgrading=!1,c.flush())})}else{a('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=l.name,c.emit("upgradeError",i)}}))}function i(){u||(u=!0,f(),l.close(),l=null)}function n(e){var r=new Error("probe error: "+e);r.transport=l.name,i(),a('probe transport "%s" failed because of error: %s',t,e),c.emit("upgradeError",r)}function o(){n("transport closed")}function s(){n("socket closed")}function h(t){l&&t.name!==l.name&&(a('"%s" works - aborting "%s"',t.name,l.name),i())}function f(){l.removeListener("open",e),l.removeListener("error",n),l.removeListener("close",o),c.removeListener("close",s),c.removeListener("upgrading",h)}a('probing transport "%s"',t);var l=this.createTransport(t,{probe:1}),u=!1,c=this;r.priorWebsocketSuccess=!1,l.once("open",e),l.once("error",n),l.once("close",o),this.once("close",s),this.once("upgrading",h),l.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},r.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(u(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},r.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},r.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},r.prototype.sendPacket=function(t,e,i,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof i&&(r=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){i=i||{},i.compress=!1!==i.compress;var n={type:t,data:e,options:i};this.emit("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function t(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function e(){r.removeListener("upgrade",e),r.removeListener("upgradeError",e),t()}function i(){r.once("upgrade",e),r.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},r.prototype.onError=function(t){a("socket error %j",t),r.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},r.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),i.writeBuffer=[],i.prevBufferLen=0}},r.prototype.filterUpgrades=function(t){for(var e=[],i=0,r=t.length;i<r;i++)~h(this.transports,t[i])&&e.push(t[i]);return e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":59,"./transports/index":60,"component-emitter":46,debug:66,"engine.io-parser":49,indexof:25,parsejson:27,parseqs:28,parseuri:31}],59:[function(t,e,i){function r(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders}var n=t("engine.io-parser"),o=t("component-emitter");e.exports=r,o(r.prototype),r.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(t){var e=n.decodePacket(t,this.socket.binaryType);this.onPacket(e)},r.prototype.onPacket=function(t){this.emit("packet",t)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":46,"engine.io-parser":49}],60:[function(t,e,i){(function(e){function r(t){var i,r=!1,a=!1,h=!1!==t.jsonp;if(e.location){var f="https:"===location.protocol,l=location.port;l||(l=f?443:80),r=t.hostname!==location.hostname||l!==t.port,a=t.secure!==f}if(t.xdomain=r,t.xscheme=a,i=new n(t),"open"in i&&!t.forceJSONP)return new o(t);if(!h)throw new Error("JSONP disabled");return new s(t)}var n=t("xmlhttprequest-ssl"),o=t("./polling-xhr"),s=t("./polling-jsonp"),a=t("./websocket");i.polling=r,i.websocket=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":61,"./polling-xhr":62,"./websocket":64,"xmlhttprequest-ssl":65}],61:[function(t,e,i){(function(i){function r(){}function n(t){o.call(this,t),this.query=this.query||{},a||(i.___eio||(i.___eio=[]),a=i.___eio),this.index=a.length;var e=this;a.push(function(t){e.onData(t)}),this.query.j=this.index,i.document&&i.addEventListener&&i.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=r)},!1)}var o=t("./polling"),s=t("component-inherit");e.exports=n;var a,h=/\n/g,f=/\\n/g;s(n,o),n.prototype.supportsBinary=!1,n.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},n.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},n.prototype.doWrite=function(t,e){function i(){r(),e()}function r(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';o=document.createElement(t)}catch(t){o=document.createElement("iframe"),o.name=n.iframeId,o.src="javascript:0"}o.id=n.iframeId,n.form.appendChild(o),n.iframe=o}var n=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),t=t.replace(f,"\\\n"),this.area.value=t.replace(h,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&i()}:this.iframe.onload=i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":63,"component-inherit":29}],62:[function(t,e,i){(function(i){function r(){}function n(t){if(h.call(this,t),i.location){var e="https:"===location.protocol,r=location.port;r||(r=e?443:80),this.xd=t.hostname!==i.location.hostname||r!==t.port,this.xs=t.secure!==e}else this.extraHeaders=t.extraHeaders}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}var a=t("xmlhttprequest-ssl"),h=t("./polling"),f=t("component-emitter"),l=t("component-inherit"),u=t("debug")("engine.io-client:polling-xhr");e.exports=n,e.exports.Request=o,l(n,h),n.prototype.supportsBinary=!0,n.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.extraHeaders=this.extraHeaders,new o(t)},n.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:i}),n=this;r.on("success",e),r.on("error",function(t){n.onError("xhr post error",t)}),this.sendXhr=r},n.prototype.doPoll=function(){u("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},f(o.prototype),o.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new a(t),r=this;try{u("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders){e.setDisableHeaderCheck(!0);for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&e.setRequestHeader(n,this.extraHeaders[n])}}catch(t){}if(this.supportsBinary&&(e.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){r.onLoad()},e.onerror=function(){r.onError(e.responseText)}):e.onreadystatechange=function(){4===e.readyState&&(200===e.status||1223===e.status?r.onLoad():setTimeout(function(){r.onError(e.status)},0))},u("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout(function(){r.onError(t)},0)}i.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,t)try{this.xhr.abort()}catch(t){}i.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(t){}if("application/octet-stream"===e)t=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(e){for(var i=new Uint8Array(this.xhr.response),r=[],n=0,o=i.length;n<o;n++)r.push(i[n]);t=String.fromCharCode.apply(null,r)}else t=this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return"undefined"!=typeof i.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},i.document&&(i.attachEvent?i.attachEvent("onunload",s):i.addEventListener&&i.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":63,"component-emitter":46,"component-inherit":29,debug:66,"xmlhttprequest-ssl":65}],63:[function(t,e,i){function r(t){var e=t&&t.forceBase64;l&&!e||(this.supportsBinary=!1),n.call(this,t)}var n=t("../transport"),o=t("parseqs"),s=t("engine.io-parser"),a=t("component-inherit"),h=t("yeast"),f=t("debug")("engine.io-client:polling");e.exports=r;var l=function(){var e=t("xmlhttprequest-ssl"),i=new e({xdomain:!1});return null!=i.responseType}();a(r,n),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(t){function e(){f("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(f("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){f("pre-pause polling complete"),--r||e()})),this.writable||(f("we are currently writing - waiting to pause"),r++,this.once("drain",function(){f("pre-pause writing complete"),--r||e()}))}else e()},r.prototype.poll=function(){f("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(t){var e=this;f("polling got data %s",t);var i=function(t,i,r){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,i),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():f('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function t(){f("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(f("transport open - closing"),t()):(f("transport not open - deferring close"),this.once("open",t))},r.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";!1!==this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"===e&&443!==this.port||"http"===e&&80!==this.port)&&(i=":"+this.port),t.length&&(t="?"+t);var r=this.hostname.indexOf(":")!==-1;return e+"://"+(r?"["+this.hostname+"]":this.hostname)+i+this.path+t}},{"../transport":59,"component-inherit":29,debug:66,"engine.io-parser":49,parseqs:28,"xmlhttprequest-ssl":65,yeast:33}],64:[function(t,e,i){(function(i){function r(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,n.call(this,t)}var n=t("../transport"),o=t("engine.io-parser"),s=t("parseqs"),a=t("component-inherit"),h=t("yeast"),f=t("debug")("engine.io-client:websocket"),l=i.WebSocket||i.MozWebSocket,u=l;if(!u&&"undefined"==typeof window)try{u=t("ws")}catch(t){}e.exports=r,a(r,n),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders);try{this.ws=l?new u(t):new u(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},r.prototype.write=function(t){function e(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var n=t.length,s=0,a=n;s<a;s++)!function(t){o.encodePacket(t,r.supportsBinary,function(o){
if(!l){var s={};if(t.options&&(s.compress=t.options.compress),r.perMessageDeflate){var a="string"==typeof o?i.Buffer.byteLength(o):o.length;a<r.perMessageDeflate.threshold&&(s.compress=!1)}}try{l?r.ws.send(o):r.ws.send(o,s)}catch(t){f("websocket closed before onclose event")}--n||e()})}(t[s])},r.prototype.onClose=function(){n.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";this.port&&("wss"===e&&443!==this.port||"ws"===e&&80!==this.port)&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||(t.b64=1),t=s.encode(t),t.length&&(t="?"+t);var r=this.hostname.indexOf(":")!==-1;return e+"://"+(r?"["+this.hostname+"]":this.hostname)+i+this.path+t},r.prototype.check=function(){return!(!u||"__initialize"in u&&this.name===r.prototype.name)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../transport":59,"component-inherit":29,debug:66,"engine.io-parser":49,parseqs:28,ws:47,yeast:33}],65:[function(t,e,i){(function(i){var r=t("has-cors");e.exports=function(t){var e=t.xdomain,n=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(t){}if(!e)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"has-cors":44}],66:[function(t,e,i){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function n(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(n++,"%c"===t&&(o=n))}),t.splice(o,0,r),t}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?i.storage.removeItem("debug"):i.storage.debug=t}catch(t){}}function a(){var t;try{t=i.storage.debug}catch(t){}return t}function h(){try{return window.localStorage}catch(t){}}i=e.exports=t("./debug"),i.log=o,i.formatArgs=n,i.save=s,i.load=a,i.useColors=r,i.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:h(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(t){return JSON.stringify(t)},i.enable(a())},{"./debug":67}],67:[function(t,e,i){function r(){return i.colors[l++%i.colors.length]}function n(t){function e(){}function n(){var t=n,e=+new Date,o=e-(f||e);t.diff=o,t.prev=f,t.curr=e,f=e,null==t.useColors&&(t.useColors=i.useColors()),null==t.color&&t.useColors&&(t.color=r());var s=Array.prototype.slice.call(arguments);s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;a++;var n=i.formatters[r];if("function"==typeof n){var o=s[a];e=n.call(t,o),s.splice(a,1),a--}return e}),"function"==typeof i.formatArgs&&(s=i.formatArgs.apply(t,s));var h=n.log||i.log||console.log.bind(console);h.apply(t,s)}e.enabled=!1,n.enabled=!0;var o=i.enabled(t)?n:e;return o.namespace=t,o}function o(t){i.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,n=0;n<r;n++)e[n]&&(t=e[n].replace(/\*/g,".*?"),"-"===t[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")))}function s(){i.enable("")}function a(t){var e,r;for(e=0,r=i.skips.length;e<r;e++)if(i.skips[e].test(t))return!1;for(e=0,r=i.names.length;e<r;e++)if(i.names[e].test(t))return!0;return!1}function h(t){return t instanceof Error?t.stack||t.message:t}i=e.exports=n,i.coerce=h,i.disable=s,i.enable=o,i.enabled=a,i.humanize=t("ms"),i.names=[],i.skips=[],i.formatters={};var f,l=0},{ms:39}],68:[function(t,e,i){(function(e){var r=t("isarray"),n=t("./is-buffer");i.deconstructPacket=function(t){function e(t){if(!t)return t;if(n(t)){var o={_placeholder:!0,num:i.length};return i.push(t),o}if(r(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a]);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var h in t)s[h]=e(t[h]);return s}return t}var i=[],o=t.data,s=t;return s.data=e(o),s.attachments=i.length,{packet:s,buffers:i}},i.reconstructPacket=function(t,e){function i(t){if(t&&t._placeholder){var n=e[t.num];return n}if(r(t)){for(var o=0;o<t.length;o++)t[o]=i(t[o]);return t}if(t&&"object"==typeof t){for(var s in t)t[s]=i(t[s]);return t}return t}return t.data=i(t.data),t.attachments=void 0,t},i.removeBlobs=function(t,i){function o(t,h,f){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){s++;var l=new FileReader;l.onload=function(){f?f[h]=this.result:a=this.result,--s||i(a)},l.readAsArrayBuffer(t)}else if(r(t))for(var u=0;u<t.length;u++)o(t[u],u,t);else if(t&&"object"==typeof t&&!n(t))for(var c in t)o(t[c],c,t)}var s=0,a=t;o(a),s||i(a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":70,isarray:26}],69:[function(t,e,i){function r(){}function n(t){var e="",r=!1;return e+=t.type,i.BINARY_EVENT!=t.type&&i.BINARY_ACK!=t.type||(e+=t.attachments,e+="-"),t.nsp&&"/"!=t.nsp&&(r=!0,e+=t.nsp),null!=t.id&&(r&&(e+=",",r=!1),e+=t.id),null!=t.data&&(r&&(e+=","),e+=c.stringify(t.data)),u("encoded %j as %s",t,e),e}function o(t,e){function i(t){var i=d.deconstructPacket(t),r=n(i.packet),o=i.buffers;o.unshift(r),e(o)}d.removeBlobs(t,i)}function s(){this.reconstructor=null}function a(t){var e={},r=0;if(e.type=Number(t.charAt(0)),null==i.types[e.type])return l();if(i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type){for(var n="";"-"!=t.charAt(++r)&&(n+=t.charAt(r),r!=t.length););if(n!=Number(n)||"-"!=t.charAt(r))throw new Error("Illegal attachments");e.attachments=Number(n)}if("/"==t.charAt(r+1))for(e.nsp="";++r;){var o=t.charAt(r);if(","==o)break;if(e.nsp+=o,r==t.length)break}else e.nsp="/";var s=t.charAt(r+1);if(""!==s&&Number(s)==s){for(e.id="";++r;){var o=t.charAt(r);if(null==o||Number(o)!=o){--r;break}if(e.id+=t.charAt(r),r==t.length)break}e.id=Number(e.id)}return t.charAt(++r)&&(e=h(e,t.substr(r))),u("decoded %s as %j",t,e),e}function h(t,e){try{t.data=c.parse(e)}catch(t){return l()}return t}function f(t){this.reconPack=t,this.buffers=[]}function l(t){return{type:i.ERROR,data:"parser error"}}var u=t("debug")("socket.io-parser"),c=t("json3"),p=t("component-emitter"),d=t("./binary"),y=t("./is-buffer");i.protocol=4,i.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],i.CONNECT=0,i.DISCONNECT=1,i.EVENT=2,i.ACK=3,i.ERROR=4,i.BINARY_EVENT=5,i.BINARY_ACK=6,i.Encoder=r,i.Decoder=s,r.prototype.encode=function(t,e){if(u("encoding packet %j",t),i.BINARY_EVENT==t.type||i.BINARY_ACK==t.type)o(t,e);else{var r=n(t);e([r])}},p(s.prototype),s.prototype.add=function(t){var e;if("string"==typeof t)e=a(t),i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type?(this.reconstructor=new f(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!y(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,this.emit("decoded",e))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":68,"./is-buffer":70,"component-emitter":46,debug:66,json3:72}],70:[function(t,e,i){(function(t){function i(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],71:[function(t,e,i){!function(i,r){"function"==typeof define&&define.amd?define([],r):"function"==typeof t&&"object"==typeof e&&e&&e.exports?e.exports=r():(i.dcodeIO=i.dcodeIO||{}).Long=r()}(this,function(){"use strict";function t(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function e(t){return(t&&t.__isLong__)===!0}function i(t,e){var i,r,o;return e?(t>>>=0,(o=0<=t&&t<256)&&(r=h[t])?r:(i=n(t,(0|t)<0?-1:0,!0),o&&(h[t]=i),i)):(t|=0,(o=-128<=t&&t<128)&&(r=a[t])?r:(i=n(t,t<0?-1:0,!1),o&&(a[t]=i),i))}function r(t,e){if(isNaN(t)||!isFinite(t))return e?g:y;if(e){if(t<0)return g;if(t>=c)return E}else{if(t<=-p)return T;if(t+1>=p)return b}return t<0?r(-t,e).neg():n(t%u|0,t/u|0,e)}function n(e,i,r){return new t(e,i,r)}function o(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(i=e,e=!1):e=!!e,i=i||10,i<2||36<i)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return o(t.substring(1),e,i).neg();for(var s=r(f(i,8)),a=y,h=0;h<t.length;h+=8){var l=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+l),i);if(l<8){var c=r(f(i,l));a=a.mul(c).add(r(u))}else a=a.mul(s),a=a.add(r(u))}return a.unsigned=e,a}function s(e){return e instanceof t?e:"number"==typeof e?r(e):"string"==typeof e?o(e):n(e.low,e.high,e.unsigned)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var a={},h={};t.fromInt=i,t.fromNumber=r,t.fromBits=n;var f=Math.pow;t.fromString=o,t.fromValue=s;var l=1<<24,u=4294967296,c=0x10000000000000000,p=c/2,d=i(l),y=i(0);t.ZERO=y;var g=i(0,!0);t.UZERO=g;var v=i(1);t.ONE=v;var m=i(1,!0);t.UONE=m;var w=i(-1);t.NEG_ONE=w;var b=n(-1,2147483647,!1);t.MAX_VALUE=b;var E=n(-1,-1,!0);t.MAX_UNSIGNED_VALUE=E;var T=n(0,-2147483648,!1);t.MIN_VALUE=T;var x=t.prototype;return x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*u+(this.low>>>0):this.high*u+(this.low>>>0)},x.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var e=r(t),i=this.div(e),n=i.mul(e).sub(this);return i.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=r(f(t,6),this.unsigned),s=this,a="";;){var h=s.div(o),l=s.sub(h.mul(o)).toInt()>>>0,u=l.toString(t);if(s=h,s.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},x.isZero=function(){return 0===this.high&&0===this.low},x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return 1===(1&this.low)},x.isEven=function(){return 0===(1&this.low)},x.equals=function(t){return e(t)||(t=s(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},x.eq=x.equals,x.notEquals=function(t){return!this.eq(t)},x.neq=x.notEquals,x.lessThan=function(t){return this.comp(t)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(t){return this.comp(t)<=0},x.lte=x.lessThanOrEqual,x.greaterThan=function(t){return this.comp(t)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(t){return this.comp(t)>=0},x.gte=x.greaterThanOrEqual,x.compare=function(t){if(e(t)||(t=s(t)),this.eq(t))return 0;var i=this.isNegative(),r=t.isNegative();return i&&!r?-1:!i&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(v)},x.neg=x.negate,x.add=function(t){e(t)||(t=s(t));var i=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,h=t.high>>>16,f=65535&t.high,l=t.low>>>16,u=65535&t.low,c=0,p=0,d=0,y=0;return y+=a+u,d+=y>>>16,y&=65535,d+=o+l,p+=d>>>16,d&=65535,p+=r+f,c+=p>>>16,p&=65535,c+=i+h,c&=65535,n(d<<16|y,c<<16|p,this.unsigned)},x.subtract=function(t){return e(t)||(t=s(t)),this.add(t.neg())},x.sub=x.subtract,x.multiply=function(t){if(this.isZero())return y;if(e(t)||(t=s(t)),t.isZero())return y;if(this.eq(T))return t.isOdd()?T:y;if(t.eq(T))return this.isOdd()?T:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(d)&&t.lt(d))return r(this.toNumber()*t.toNumber(),this.unsigned);var i=this.high>>>16,o=65535&this.high,a=this.low>>>16,h=65535&this.low,f=t.high>>>16,l=65535&t.high,u=t.low>>>16,c=65535&t.low,p=0,g=0,v=0,m=0;return m+=h*c,v+=m>>>16,m&=65535,v+=a*c,g+=v>>>16,v&=65535,v+=h*u,g+=v>>>16,v&=65535,g+=o*c,p+=g>>>16,g&=65535,g+=a*u,p+=g>>>16,g&=65535,g+=h*l,p+=g>>>16,g&=65535,p+=i*c+o*u+a*l+h*f,p&=65535,n(v<<16|m,p<<16|g,this.unsigned)},x.mul=x.multiply,x.divide=function(t){if(e(t)||(t=s(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:y;var i,n,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return m;o=g}else{if(this.eq(T)){if(t.eq(v)||t.eq(w))return T;if(t.eq(T))return v;var a=this.shr(1);return i=a.div(t).shl(1),i.eq(y)?t.isNegative()?v:w:(n=this.sub(t.mul(i)),o=i.add(n.div(t)))}if(t.eq(T))return this.unsigned?g:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=y}for(n=this;n.gte(t);){i=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var h=Math.ceil(Math.log(i)/Math.LN2),l=h<=48?1:f(2,h-48),u=r(i),c=u.mul(t);c.isNegative()||c.gt(n);)i-=l,u=r(i,this.unsigned),c=u.mul(t);u.isZero()&&(u=v),o=o.add(u),n=n.sub(c)}return o},x.div=x.divide,x.modulo=function(t){return e(t)||(t=s(t)),this.sub(this.div(t).mul(t))},x.mod=x.modulo,x.not=function(){return n(~this.low,~this.high,this.unsigned)},x.and=function(t){return e(t)||(t=s(t)),n(this.low&t.low,this.high&t.high,this.unsigned)},x.or=function(t){return e(t)||(t=s(t)),n(this.low|t.low,this.high|t.high,this.unsigned)},x.xor=function(t){return e(t)||(t=s(t)),n(this.low^t.low,this.high^t.high,this.unsigned)},x.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?n(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):n(0,this.low<<t-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(t){return e(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?n(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):n(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),t&=63,0===t)return this;var i=this.high;if(t<32){var r=this.low;return n(r>>>t|i<<32-t,i>>>t,this.unsigned)}return 32===t?n(i,0,this.unsigned):n(i>>>t-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?n(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:n(this.low,this.high,!0)},x.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},x.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t})},{}],72:[function(t,e,i){(function(t){(function(){function r(t,e){function i(t){if(i[t]!==g)return i[t];var r;if("bug-string-char-index"==t)r="a"!="a"[0];else if("json"==t)r=i("json-stringify")&&i("json-parse");else{var o,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var h=e.stringify,l="function"==typeof h&&w;if(l){(o=function(){return 1}).toJSON=o;try{l="0"===h(0)&&"0"===h(new n)&&'""'==h(new s)&&h(m)===g&&h(g)===g&&h()===g&&"1"===h(o)&&"[1]"==h([o])&&"[null]"==h([g])&&"null"==h(null)&&"[null,null,null]"==h([g,m,null])&&h({a:[o,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===h(null,o)&&"[\n 1,\n 2\n]"==h([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==h(new f(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==h(new f(864e13))&&'"-000001-01-01T00:00:00.000Z"'==h(new f(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==h(new f(-1))}catch(t){l=!1}}r=l}if("json-parse"==t){var u=e.parse;if("function"==typeof u)try{if(0===u("0")&&!u(!1)){o=u(a);var c=5==o.a.length&&1===o.a[0];if(c){try{c=!u('"\t"')}catch(t){}if(c)try{c=1!==u("01")}catch(t){}if(c)try{c=1!==u("1.")}catch(t){}}}}catch(t){c=!1}r=c}}return i[t]=!!r}t||(t=a.Object()),e||(e=a.Object());var n=t.Number||a.Number,s=t.String||a.String,h=t.Object||a.Object,f=t.Date||a.Date,l=t.SyntaxError||a.SyntaxError,u=t.TypeError||a.TypeError,c=t.Math||a.Math,p=t.JSON||a.JSON;"object"==typeof p&&p&&(e.stringify=p.stringify,e.parse=p.parse);var d,y,g,v=h.prototype,m=v.toString,w=new f(-0xc782b5b800cec);try{w=w.getUTCFullYear()==-109252&&0===w.getUTCMonth()&&1===w.getUTCDate()&&10==w.getUTCHours()&&37==w.getUTCMinutes()&&6==w.getUTCSeconds()&&708==w.getUTCMilliseconds()}catch(t){}if(!i("json")){var b="[object Function]",E="[object Date]",T="[object Number]",x="[object String]",S="[object Array]",k="[object Boolean]",I=i("bug-string-char-index");if(!w)var A=c.floor,R=[0,31,59,90,120,151,181,212,243,273,304,334],P=function(t,e){return R[e]+365*(t-1970)+A((t-1969+(e=+(e>1)))/4)-A((t-1901+e)/100)+A((t-1601+e)/400)};if((d=v.hasOwnProperty)||(d=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=m?d=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,d=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,d.call(this,t)}),y=function(t,e){var i,r,n,s=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,r=new i;for(n in r)d.call(r,n)&&s++;return i=r=null,s?y=2==s?function(t,e){var i,r={},n=m.call(t)==b;for(i in t)n&&"prototype"==i||d.call(r,i)||!(r[i]=1)||!d.call(t,i)||e(i)}:function(t,e){var i,r,n=m.call(t)==b;for(i in t)n&&"prototype"==i||!d.call(t,i)||(r="constructor"===i)||e(i);(r||d.call(t,i="constructor"))&&e(i)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],y=function(t,e){var i,n,s=m.call(t)==b,a=!s&&"function"!=typeof t.constructor&&o[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(i in t)s&&"prototype"==i||!a.call(t,i)||e(i);for(n=r.length;i=r[--n];a.call(t,i)&&e(i));}),y(t,e)},!i("json-stringify")){var _={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},O="000000",N=function(t,e){return(O+(e||0)).slice(-t)},B="\\u00",C=function(t){for(var e='"',i=0,r=t.length,n=!I||r>10,o=n&&(I?t.split(""):t);i<r;i++){var s=t.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=_[s];break;default:if(s<32){e+=B+N(2,s.toString(16));break}e+=n?o[i]:t.charAt(i)}}return e+'"'},L=function(t,e,i,r,n,o,s){var a,h,f,l,c,p,v,w,b,I,R,_,O,B,M,U;try{a=e[t]}catch(t){}if("object"==typeof a&&a)if(h=m.call(a),h!=E||d.call(a,"toJSON"))"function"==typeof a.toJSON&&(h!=T&&h!=x&&h!=S||d.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&a<1/0){if(P){for(c=A(a/864e5),f=A(c/365.2425)+1970-1;P(f+1,0)<=c;f++);for(l=A((c-P(f,0))/30.42);P(f,l+1)<=c;l++);c=1+c-P(f,l),p=(a%864e5+864e5)%864e5,v=A(p/36e5)%24,w=A(p/6e4)%60,b=A(p/1e3)%60,I=p%1e3}else f=a.getUTCFullYear(),l=a.getUTCMonth(),c=a.getUTCDate(),v=a.getUTCHours(),w=a.getUTCMinutes(),b=a.getUTCSeconds(),I=a.getUTCMilliseconds();a=(f<=0||f>=1e4?(f<0?"-":"+")+N(6,f<0?-f:f):N(4,f))+"-"+N(2,l+1)+"-"+N(2,c)+"T"+N(2,v)+":"+N(2,w)+":"+N(2,b)+"."+N(3,I)+"Z"}else a=null;if(i&&(a=i.call(e,t,a)),null===a)return"null";if(h=m.call(a),h==k)return""+a;if(h==T)return a>-1/0&&a<1/0?""+a:"null";if(h==x)return C(""+a);if("object"==typeof a){for(B=s.length;B--;)if(s[B]===a)throw u();if(s.push(a),R=[],M=o,o+=n,h==S){for(O=0,B=a.length;O<B;O++)_=L(O,a,i,r,n,o,s),R.push(_===g?"null":_);U=R.length?n?"[\n"+o+R.join(",\n"+o)+"\n"+M+"]":"["+R.join(",")+"]":"[]"}else y(r||a,function(t){var e=L(t,a,i,r,n,o,s);e!==g&&R.push(C(t)+":"+(n?" ":"")+e)}),U=R.length?n?"{\n"+o+R.join(",\n"+o)+"\n"+M+"}":"{"+R.join(",")+"}":"{}";return s.pop(),U}};e.stringify=function(t,e,i){var r,n,s,a;if(o[typeof e]&&e)if((a=m.call(e))==b)n=e;else if(a==S){s={};for(var h,f=0,l=e.length;f<l;h=e[f++],a=m.call(h),(a==x||a==T)&&(s[h]=1));}if(i)if((a=m.call(i))==T){if((i-=i%1)>0)for(r="",i>10&&(i=10);r.length<i;r+=" ");}else a==x&&(r=i.length<=10?i:i.slice(0,10));return L("",(h={},h[""]=t,h),n,s,r,"",[])}}if(!i("json-parse")){var M,U,D=s.fromCharCode,Y={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},F=function(){throw M=U=null,l()},j=function(){for(var t,e,i,r,n,o=U,s=o.length;M<s;)switch(n=o.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=I?o.charAt(M):o[M],M++,t;case 34:for(t="@",M++;M<s;)if(n=o.charCodeAt(M),n<32)F();else if(92==n)switch(n=o.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=Y[n],M++;break;case 117:for(e=++M,i=M+4;M<i;M++)n=o.charCodeAt(M),n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70||F();t+=D("0x"+o.slice(e,M));break;default:F()}else{if(34==n)break;for(n=o.charCodeAt(M),e=M;n>=32&&92!=n&&34!=n;)n=o.charCodeAt(++M);t+=o.slice(e,M)}if(34==o.charCodeAt(M))return M++,t;F();default:if(e=M,45==n&&(r=!0,n=o.charCodeAt(++M)),n>=48&&n<=57){for(48==n&&(n=o.charCodeAt(M+1),n>=48&&n<=57)&&F(),r=!1;M<s&&(n=o.charCodeAt(M),n>=48&&n<=57);M++);if(46==o.charCodeAt(M)){for(i=++M;i<s&&(n=o.charCodeAt(i),n>=48&&n<=57);i++);i==M&&F(),M=i}if(n=o.charCodeAt(M),101==n||69==n){for(n=o.charCodeAt(++M),43!=n&&45!=n||M++,i=M;i<s&&(n=o.charCodeAt(i),n>=48&&n<=57);i++);i==M&&F(),M=i}return+o.slice(e,M)}if(r&&F(),"true"==o.slice(M,M+4))return M+=4,!0;if("false"==o.slice(M,M+5))return M+=5,!1;if("null"==o.slice(M,M+4))return M+=4,null;F()}return"$"},V=function(t){var e,i;if("$"==t&&F(),"string"==typeof t){if("@"==(I?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=j(),"]"!=t;i||(i=!0))i&&(","==t?(t=j(),"]"==t&&F()):F()),","==t&&F(),e.push(V(t));return e}if("{"==t){for(e={};t=j(),"}"!=t;i||(i=!0))i&&(","==t?(t=j(),"}"==t&&F()):F()),","!=t&&"string"==typeof t&&"@"==(I?t.charAt(0):t[0])&&":"==j()||F(),e[t.slice(1)]=V(j());return e}F()}return t},q=function(t,e,i){var r=z(t,e,i);r===g?delete t[e]:t[e]=r},z=function(t,e,i){var r,n=t[e];if("object"==typeof n&&n)if(m.call(n)==S)for(r=n.length;r--;)q(n,r,i);else y(n,function(t){q(n,t,i)});return i.call(t,e,n)};e.parse=function(t,e){var i,r;return M=0,U=""+t,i=V(j()),"$"!=j()&&F(),M=U=null,e&&m.call(e)==b?z((r={},r[""]=i,r),"",e):i}}}return e.runInContext=r,e}var n="function"==typeof define&&define.amd,o={function:!0,object:!0},s=o[typeof i]&&i&&!i.nodeType&&i,a=o[typeof window]&&window||this,h=s&&o[typeof e]&&e&&!e.nodeType&&"object"==typeof t&&t;if(!h||h.global!==h&&h.window!==h&&h.self!==h||(a=h),s&&!n)r(a,s);else{var f=a.JSON,l=a.JSON3,u=!1,c=r(a,a.JSON3={noConflict:function(){return u||(u=!0,a.JSON=f,a.JSON3=l,f=l=null),c}});a.JSON={parse:c.parse,stringify:c.stringify}}n&&define(function(){return c})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],73:[function(t,e,i){!function(i,r){"function"==typeof define&&define.amd?define(["long"],r):"function"==typeof t&&"object"==typeof e&&e&&e.exports?e.exports=function(){var e;try{e=t("long")}catch(t){}return r(e)}():(i.dcodeIO=i.dcodeIO||{}).ByteBuffer=r(i.dcodeIO.Long)}(this,function(t){"use strict";function e(t){var e=0;return function(){return e<t.length?t.charCodeAt(e++):null}}function i(){var t=[],e=[];return function(){return 0===arguments.length?e.join("")+h.apply(String,t):(t.length+arguments.length>1024&&(e.push(h.apply(String,t)),t.length=0),void Array.prototype.push.apply(t,arguments))}}function r(t,e,i,r,n){var o,s,a=8*n-r-1,h=(1<<a)-1,f=h>>1,l=-7,u=i?n-1:0,c=i?-1:1,p=t[e+u];for(u+=c,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+u],u+=c,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+u],u+=c,l-=8);if(0===o)o=1-f;else{if(o===h)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),o-=f}return(p?-1:1)*s*Math.pow(2,o-r)}function n(t,e,i,r,n,o){var s,a,h,f=8*o-n-1,l=(1<<f)-1,u=l>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),e+=s+u>=1?c/h:c*Math.pow(2,1-u),e*h>=2&&(s++,h/=2),s+u>=l?(a=0,s=l):s+u>=1?(a=(e*h-1)*Math.pow(2,n),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,n),s=0));n>=8;t[i+p]=255&a,p+=d,a/=256,n-=8);for(s=s<<n|a,f+=n;f>0;t[i+p]=255&s,p+=d,s/=256,f-=8);t[i+p-d]|=128*y}var o=function(t,e,i){if("undefined"==typeof t&&(t=o.DEFAULT_CAPACITY),"undefined"==typeof e&&(e=o.DEFAULT_ENDIAN),"undefined"==typeof i&&(i=o.DEFAULT_NOASSERT),!i){if(t|=0,t<0)throw RangeError("Illegal capacity");e=!!e,i=!!i}this.buffer=0===t?a:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=e,this.noAssert=i};o.VERSION="5.0.1",o.LITTLE_ENDIAN=!0,o.BIG_ENDIAN=!1,o.DEFAULT_CAPACITY=16,o.DEFAULT_ENDIAN=o.BIG_ENDIAN,o.DEFAULT_NOASSERT=!1,o.Long=t||null;var s=o.prototype;s.__isByteBuffer__,Object.defineProperty(s,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var a=new ArrayBuffer(0),h=String.fromCharCode;o.accessor=function(){return Uint8Array},o.allocate=function(t,e,i){return new o(t,e,i)},o.concat=function(t,e,i,r){"boolean"!=typeof e&&"string"==typeof e||(r=i,i=e,e=void 0);for(var n,s=0,a=0,h=t.length;a<h;++a)o.isByteBuffer(t[a])||(t[a]=o.wrap(t[a],e)),n=t[a].limit-t[a].offset,n>0&&(s+=n);if(0===s)return new o(0,i,r);var f,l=new o(s,i,r);for(a=0;a<h;)f=t[a++],n=f.limit-f.offset,n<=0||(l.view.set(f.view.subarray(f.offset,f.limit),l.offset),l.offset+=n);return l.limit=l.offset,l.offset=0,l},o.isByteBuffer=function(t){return(t&&t.__isByteBuffer__)===!0},o.type=function(){return ArrayBuffer},o.wrap=function(t,e,i,r){if("string"!=typeof e&&(r=i,i=e,e=void 0),"string"==typeof t)switch("undefined"==typeof e&&(e="utf8"),e){case"base64":return o.fromBase64(t,i);case"hex":return o.fromHex(t,i);case"binary":return o.fromBinary(t,i);case"utf8":return o.fromUTF8(t,i);case"debug":return o.fromDebug(t,i);default:throw Error("Unsupported encoding: "+e)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var n;if(o.isByteBuffer(t))return n=s.clone.call(t),n.markedOffset=-1,n;if(t instanceof Uint8Array)n=new o(0,i,r),t.length>0&&(n.buffer=t.buffer,n.offset=t.byteOffset,n.limit=t.byteOffset+t.byteLength,n.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)n=new o(0,i,r),t.byteLength>0&&(n.buffer=t,n.offset=0,n.limit=t.byteLength,n.view=t.byteLength>0?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");n=new o(t.length,i,r),n.limit=t.length;for(var a=0;a<t.length;++a)n.view[a]=t[a]}return n},s.writeBitSet=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if(!(t instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var r,n=e,o=t.length,s=o>>3,a=0;for(e+=this.writeVarint32(o,e);s--;)r=1&!!t[a++]|(1&!!t[a++])<<1|(1&!!t[a++])<<2|(1&!!t[a++])<<3|(1&!!t[a++])<<4|(1&!!t[a++])<<5|(1&!!t[a++])<<6|(1&!!t[a++])<<7,this.writeByte(r,e++);if(a<o){var h=0;for(r=0;a<o;)r|=(1&!!t[a++])<<h++;this.writeByte(r,e++)}return i?(this.offset=e,this):e-n},s.readBitSet=function(t){var e="undefined"==typeof t;e&&(t=this.offset);var i,r=this.readVarint32(t),n=r.value,o=n>>3,s=0,a=[];for(t+=r.length;o--;)i=this.readByte(t++),a[s++]=!!(1&i),a[s++]=!!(2&i),a[s++]=!!(4&i),a[s++]=!!(8&i),a[s++]=!!(16&i),a[s++]=!!(32&i),a[s++]=!!(64&i),a[s++]=!!(128&i);if(s<n){var h=0;for(i=this.readByte(t++);s<n;)a[s++]=!!(i>>h++&1)}return e&&(this.offset=t),a},s.readBytes=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+"+t+") <= "+this.buffer.byteLength)}var r=this.slice(e,e+t);return i&&(this.offset+=t),r},s.writeBytes=s.append,s.writeInt8=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=1;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=1,this.view[e]=t,i&&(this.offset+=1),this},s.writeByte=s.writeInt8,s.readInt8=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i=this.view[t];return 128===(128&i)&&(i=-(255-i+1)),e&&(this.offset+=1),i},s.readByte=s.readInt8,s.writeUint8=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=1;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=1,this.view[e]=t,i&&(this.offset+=1),this},s.writeUInt8=s.writeUint8,s.readUint8=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i=this.view[t];return e&&(this.offset+=1),i},s.readUInt8=s.readUint8,s.writeInt16=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=2;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=2,this.littleEndian?(this.view[e+1]=(65280&t)>>>8,this.view[e]=255&t):(this.view[e]=(65280&t)>>>8,this.view[e+1]=255&t),i&&(this.offset+=2),this},s.writeShort=s.writeInt16,s.readInt16=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength);
}var i=0;return this.littleEndian?(i=this.view[t],i|=this.view[t+1]<<8):(i=this.view[t]<<8,i|=this.view[t+1]),32768===(32768&i)&&(i=-(65535-i+1)),e&&(this.offset+=2),i},s.readShort=s.readInt16,s.writeUint16=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=2;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=2,this.littleEndian?(this.view[e+1]=(65280&t)>>>8,this.view[e]=255&t):(this.view[e]=(65280&t)>>>8,this.view[e+1]=255&t),i&&(this.offset+=2),this},s.writeUInt16=s.writeUint16,s.readUint16=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t],i|=this.view[t+1]<<8):(i=this.view[t]<<8,i|=this.view[t+1]),e&&(this.offset+=2),i},s.readUInt16=s.readUint16,s.writeInt32=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=4,this.littleEndian?(this.view[e+3]=t>>>24&255,this.view[e+2]=t>>>16&255,this.view[e+1]=t>>>8&255,this.view[e]=255&t):(this.view[e]=t>>>24&255,this.view[e+1]=t>>>16&255,this.view[e+2]=t>>>8&255,this.view[e+3]=255&t),i&&(this.offset+=4),this},s.writeInt=s.writeInt32,s.readInt32=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0),i|=0,e&&(this.offset+=4),i},s.readInt=s.readInt32,s.writeUint32=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=4,this.littleEndian?(this.view[e+3]=t>>>24&255,this.view[e+2]=t>>>16&255,this.view[e+1]=t>>>8&255,this.view[e]=255&t):(this.view[e]=t>>>24&255,this.view[e+1]=t>>>16&255,this.view[e+2]=t>>>8&255,this.view[e+3]=255&t),i&&(this.offset+=4),this},s.writeUInt32=s.writeUint32,s.readUint32=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0),e&&(this.offset+=4),i},s.readUInt32=s.readUint32,t&&(s.writeInt64=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var o=e.low,s=e.high;return this.littleEndian?(this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o,i+=4,this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s):(this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s,i+=4,this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o),r&&(this.offset+=8),this},s.writeLong=s.writeInt64,s.readInt64=function(e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var r=0,n=0;this.littleEndian?(r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0,e+=4,n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0,e+=4,r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0);var o=new t(r,n,!1);return i&&(this.offset+=8),o},s.readLong=s.readInt64,s.writeUint64=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var o=e.low,s=e.high;return this.littleEndian?(this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o,i+=4,this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s):(this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s,i+=4,this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o),r&&(this.offset+=8),this},s.writeUInt64=s.writeUint64,s.readUint64=function(e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var r=0,n=0;this.littleEndian?(r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0,e+=4,n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0,e+=4,r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0);var o=new t(r,n,!0);return i&&(this.offset+=8),o},s.readUInt64=s.readUint64),s.writeFloat32=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=4,n(this.view,t,e,this.littleEndian,23,4),i&&(this.offset+=4),this},s.writeFloat=s.writeFloat32,s.readFloat32=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=r(this.view,t,this.littleEndian,23,4);return e&&(this.offset+=4),i},s.readFloat=s.readFloat32,s.writeFloat64=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=8;var r=this.buffer.byteLength;return e>r&&this.resize((r*=2)>e?r:e),e-=8,n(this.view,t,e,this.littleEndian,52,8),i&&(this.offset+=8),this},s.writeDouble=s.writeFloat64,s.readFloat64=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var i=r(this.view,t,this.littleEndian,52,8);return e&&(this.offset+=8),i},s.readDouble=s.readFloat64,o.MAX_VARINT32_BYTES=5,o.calculateVarint32=function(t){return t>>>=0,t<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},o.zigZagEncode32=function(t){return((t|=0)<<1^t>>31)>>>0},o.zigZagDecode32=function(t){return t>>>1^-(1&t)|0},s.writeVarint32=function(t,e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var r,n=o.calculateVarint32(t);e+=n;var s=this.buffer.byteLength;for(e>s&&this.resize((s*=2)>e?s:e),e-=n,t>>>=0;t>=128;)r=127&t|128,this.view[e++]=r,t>>>=7;return this.view[e++]=t,i?(this.offset=e,this):n},s.writeVarint32ZigZag=function(t,e){return this.writeVarint32(o.zigZagEncode32(t),e)},s.readVarint32=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i,r=0,n=0;do{if(!this.noAssert&&t>this.limit){var o=Error("Truncated");throw o.truncated=!0,o}i=this.view[t++],r<5&&(n|=(127&i)<<7*r),++r}while(0!==(128&i));return n|=0,e?(this.offset=t,n):{value:n,length:r}},s.readVarint32ZigZag=function(t){var e=this.readVarint32(t);return"object"==typeof e?e.value=o.zigZagDecode32(e.value):e=o.zigZagDecode32(e),e},t&&(o.MAX_VARINT64_BYTES=10,o.calculateVarint64=function(e){"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e));var i=e.toInt()>>>0,r=e.shiftRightUnsigned(28).toInt()>>>0,n=e.shiftRightUnsigned(56).toInt()>>>0;return 0==n?0==r?i<16384?i<128?1:2:i<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:n<128?9:10},o.zigZagEncode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):e.unsigned!==!1&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},o.zigZagDecode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):e.unsigned!==!1&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(t.ONE).toSigned().negate()).toSigned()},s.writeVarint64=function(e,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):e.unsigned!==!1&&(e=e.toSigned());var n=o.calculateVarint64(e),s=e.toInt()>>>0,a=e.shiftRightUnsigned(28).toInt()>>>0,h=e.shiftRightUnsigned(56).toInt()>>>0;i+=n;var f=this.buffer.byteLength;switch(i>f&&this.resize((f*=2)>i?f:i),i-=n,n){case 10:this.view[i+9]=h>>>7&1;case 9:this.view[i+8]=9!==n?128|h:127&h;case 8:this.view[i+7]=8!==n?a>>>21|128:a>>>21&127;case 7:this.view[i+6]=7!==n?a>>>14|128:a>>>14&127;case 6:this.view[i+5]=6!==n?a>>>7|128:a>>>7&127;case 5:this.view[i+4]=5!==n?128|a:127&a;case 4:this.view[i+3]=4!==n?s>>>21|128:s>>>21&127;case 3:this.view[i+2]=3!==n?s>>>14|128:s>>>14&127;case 2:this.view[i+1]=2!==n?s>>>7|128:s>>>7&127;case 1:this.view[i]=1!==n?128|s:127&s}return r?(this.offset+=n,this):n},s.writeVarint64ZigZag=function(t,e){return this.writeVarint64(o.zigZagEncode64(t),e)},s.readVarint64=function(e){var i="undefined"==typeof e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r=e,n=0,o=0,s=0,a=0;if(a=this.view[e++],n=127&a,128&a&&(a=this.view[e++],n|=(127&a)<<7,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],n|=(127&a)<<14,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],n|=(127&a)<<21,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],o=127&a,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],o|=(127&a)<<7,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],o|=(127&a)<<14,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],o|=(127&a)<<21,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],s=127&a,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[e++],s|=(127&a)<<7,128&a||this.noAssert&&"undefined"==typeof a))))))))))throw Error("Buffer overrun");var h=t.fromBits(n|o<<28,o>>>4|s<<24,!1);return i?(this.offset=e,h):{value:h,length:e-r}},s.readVarint64ZigZag=function(e){var i=this.readVarint64(e);return i&&i.value instanceof t?i.value=o.zigZagDecode64(i.value):i=o.zigZagDecode64(i),i}),s.writeCString=function(t,i){var r="undefined"==typeof i;r&&(i=this.offset);var n,o=t.length;if(!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(n=0;n<o;++n)if(0===t.charCodeAt(n))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}o=l.calculateUTF16asUTF8(e(t))[1],i+=o+1;var s=this.buffer.byteLength;return i>s&&this.resize((s*=2)>i?s:i),i-=o+1,l.encodeUTF16toUTF8(e(t),function(t){this.view[i++]=t}.bind(this)),this.view[i++]=0,r?(this.offset=i,this):o},s.readCString=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r,n=t,o=-1;return l.decodeUTF8toUTF16(function(){if(0===o)return null;if(t>=this.limit)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.limit);return o=this.view[t++],0===o?null:o}.bind(this),r=i(),!0),e?(this.offset=t,r()):{string:r(),length:t-n}},s.writeIString=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,o=i;n=l.calculateUTF16asUTF8(e(t),this.noAssert)[1],i+=4+n;var s=this.buffer.byteLength;if(i>s&&this.resize((s*=2)>i?s:i),i-=4+n,this.littleEndian?(this.view[i+3]=n>>>24&255,this.view[i+2]=n>>>16&255,this.view[i+1]=n>>>8&255,this.view[i]=255&n):(this.view[i]=n>>>24&255,this.view[i+1]=n>>>16&255,this.view[i+2]=n>>>8&255,this.view[i+3]=255&n),i+=4,l.encodeUTF16toUTF8(e(t),function(t){this.view[i++]=t}.bind(this)),i!==o+4+n)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+n));return r?(this.offset=i,this):i-o},s.readIString=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=t,r=this.readUint32(t),n=this.readUTF8String(r,o.METRICS_BYTES,t+=4);return t+=n.length,e?(this.offset=t,n.string):{string:n.string,length:t-i}},o.METRICS_CHARS="c",o.METRICS_BYTES="b",s.writeUTF8String=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,o=i;n=l.calculateUTF16asUTF8(e(t))[1],i+=n;var s=this.buffer.byteLength;return i>s&&this.resize((s*=2)>i?s:i),i-=n,l.encodeUTF16toUTF8(e(t),function(t){this.view[i++]=t}.bind(this)),r?(this.offset=i,this):i-o},s.writeString=s.writeUTF8String,o.calculateUTF8Chars=function(t){return l.calculateUTF16asUTF8(e(t))[0]},o.calculateUTF8Bytes=function(t){return l.calculateUTF16asUTF8(e(t))[1]},o.calculateString=o.calculateUTF8Bytes,s.readUTF8String=function(t,e,r){"number"==typeof e&&(r=e,e=void 0);var n="undefined"==typeof r;if(n&&(r=this.offset),"undefined"==typeof e&&(e=o.METRICS_CHARS),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,r<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var s,a=0,h=r;if(e===o.METRICS_CHARS){if(s=i(),l.decodeUTF8(function(){return a<t&&r<this.limit?this.view[r++]:null}.bind(this),function(t){++a,l.UTF8toUTF16(t,s)}),a!==t)throw RangeError("Illegal range: Truncated data, "+a+" == "+t);return n?(this.offset=r,s()):{string:s(),length:r-h}}if(e===o.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,r<0||r+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+t+") <= "+this.buffer.byteLength)}var f=r+t;if(l.decodeUTF8toUTF16(function(){return r<f?this.view[r++]:null}.bind(this),s=i(),this.noAssert),r!==f)throw RangeError("Illegal range: Truncated data, "+r+" == "+f);return n?(this.offset=r,s()):{string:s(),length:r-h}}throw TypeError("Unsupported metrics: "+e)},s.readString=s.readUTF8String,s.writeVString=function(t,i){var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,s,a=i;n=l.calculateUTF16asUTF8(e(t),this.noAssert)[1],s=o.calculateVarint32(n),i+=s+n;var h=this.buffer.byteLength;if(i>h&&this.resize((h*=2)>i?h:i),i-=s+n,i+=this.writeVarint32(n,i),l.encodeUTF16toUTF8(e(t),function(t){this.view[i++]=t}.bind(this)),i!==a+n+s)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+n+s));return r?(this.offset=i,this):i-a},s.readVString=function(t){var e="undefined"==typeof t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i=t,r=this.readVarint32(t),n=this.readUTF8String(r.value,o.METRICS_BYTES,t+=r.length);return t+=n.length,e?(this.offset=t,n.string):{string:n.string,length:t-i}},s.append=function(t,e,i){"number"!=typeof e&&"string"==typeof e||(i=e,e=void 0);var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}t instanceof o||(t=o.wrap(t,e));var n=t.limit-t.offset;if(n<=0)return this;i+=n;var s=this.buffer.byteLength;return i>s&&this.resize((s*=2)>i?s:i),i-=n,this.view.set(t.view.subarray(t.offset,t.limit),i),t.offset+=n,r&&(this.offset+=n),this},s.appendTo=function(t,e){return t.append(this,e),this},s.assert=function(t){return this.noAssert=!t,this},s.capacity=function(){return this.buffer.byteLength},s.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},s.clone=function(t){var e=new o(0,this.littleEndian,this.noAssert);return t?(e.buffer=new ArrayBuffer(this.buffer.byteLength),e.view=new Uint8Array(e.buffer)):(e.buffer=this.buffer,e.view=this.view),e.offset=this.offset,e.markedOffset=this.markedOffset,e.limit=this.limit,e},s.compact=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}if(0===t&&e===this.buffer.byteLength)return this;var i=e-t;if(0===i)return this.buffer=a,this.view=null,this.markedOffset>=0&&(this.markedOffset-=t),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(i),n=new Uint8Array(r);return n.set(this.view.subarray(t,e)),this.buffer=r,this.view=n,this.markedOffset>=0&&(this.markedOffset-=t),this.offset=0,this.limit=i,this},s.copy=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}if(t===e)return new o(0,this.littleEndian,this.noAssert);var i=e-t,r=new o(i,this.littleEndian,this.noAssert);return r.offset=0,r.limit=i,r.markedOffset>=0&&(r.markedOffset-=t),this.copyTo(r,0,t,e),r},s.copyTo=function(t,e,i,r){var n,s;if(!this.noAssert&&!o.isByteBuffer(t))throw TypeError("Illegal target: Not a ByteBuffer");if(e=(s="undefined"==typeof e)?t.offset:0|e,i=(n="undefined"==typeof i)?this.offset:0|i,r="undefined"==typeof r?this.limit:0|r,e<0||e>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+e+" <= "+t.buffer.byteLength);if(i<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+i+" <= "+this.buffer.byteLength);var a=r-i;return 0===a?t:(t.ensureCapacity(e+a),t.view.set(this.view.subarray(i,r),e),n&&(this.offset+=a),s&&(t.offset+=a),this)},s.ensureCapacity=function(t){var e=this.buffer.byteLength;return e<t?this.resize((e*=2)>t?e:t):this},s.fill=function(t,e,i){var r="undefined"==typeof e;if(r&&(e=this.offset),"string"==typeof t&&t.length>0&&(t=t.charCodeAt(0)),"undefined"==typeof e&&(e=this.offset),"undefined"==typeof i&&(i=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof i||i%1!==0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,e<0||e>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+i+" <= "+this.buffer.byteLength)}if(e>=i)return this;for(;e<i;)this.view[e++]=t;return r&&(this.offset=e),this},s.flip=function(){return this.limit=this.offset,this.offset=0,this},s.mark=function(t){if(t="undefined"==typeof t?this.offset:t,!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=t,this},s.order=function(t){if(!this.noAssert&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!t,this},s.LE=function(t){return this.littleEndian="undefined"==typeof t||!!t,this},s.BE=function(t){return this.littleEndian="undefined"!=typeof t&&!t,this},s.prepend=function(t,e,i){"number"!=typeof e&&"string"==typeof e||(i=e,e=void 0);var r="undefined"==typeof i;if(r&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}t instanceof o||(t=o.wrap(t,e));var n=t.limit-t.offset;if(n<=0)return this;var s=n-i;if(s>0){var a=new ArrayBuffer(this.buffer.byteLength+s),h=new Uint8Array(a);h.set(this.view.subarray(i,this.buffer.byteLength),n),this.buffer=a,this.view=h,this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,i+=s}else{new Uint8Array(this.buffer)}return this.view.set(t.view.subarray(t.offset,t.limit),i-n),t.offset=t.limit,r&&(this.offset-=n),this},s.prependTo=function(t,e){return t.prepend(this,e),this},s.printDebug=function(t){"function"!=typeof t&&(t=console.log.bind(console)),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},s.remaining=function(){return this.limit-this.offset},s.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},s.resize=function(t){if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if(t|=0,t<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var e=new ArrayBuffer(t),i=new Uint8Array(e);i.set(this.view),this.buffer=e,this.view=i}return this},s.reverse=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}return t===e?this:(Array.prototype.reverse.call(this.view.subarray(t,e)),this)},s.skip=function(t){if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var e=this.offset+t;if(!this.noAssert&&(e<0||e>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=e,this},s.slice=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}var i=this.clone();return i.offset=t,i.limit=e,i},s.toBuffer=function(t){var e=this.offset,i=this.limit;if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: Not an integer");if(e>>>=0,"number"!=typeof i||i%1!==0)throw TypeError("Illegal limit: Not an integer");if(i>>>=0,e<0||e>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+i+" <= "+this.buffer.byteLength)}if(!t&&0===e&&i===this.buffer.byteLength)return this.buffer;if(e===i)return a;var r=new ArrayBuffer(i-e);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(e,i),0),r},s.toArrayBuffer=s.toBuffer,s.toString=function(t,e,i){if("undefined"==typeof t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof t&&(t="utf8",e=t,i=e),t){case"utf8":return this.toUTF8(e,i);case"base64":return this.toBase64(e,i);case"hex":return this.toHex(e,i);case"binary":return this.toBinary(e,i);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+t)}};var f=function(){for(var t={},e=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[],r=0,n=e.length;r<n;++r)i[e[r]]=r;return t.encode=function(t,i){for(var r,n;null!==(r=t());)i(e[r>>2&63]),n=(3&r)<<4,null!==(r=t())?(n|=r>>4&15,i(e[63&(n|r>>4&15)]),n=(15&r)<<2,null!==(r=t())?(i(e[63&(n|r>>6&3)]),i(e[63&r])):(i(e[63&n]),i(61))):(i(e[63&n]),i(61),i(61))},t.decode=function(t,e){function r(t){throw Error("Illegal character code: "+t)}for(var n,o,s;null!==(n=t());)if(o=i[n],"undefined"==typeof o&&r(n),null!==(n=t())&&(s=i[n],"undefined"==typeof s&&r(n),e(o<<2>>>0|(48&s)>>4),null!==(n=t()))){if(o=i[n],"undefined"==typeof o){if(61===n)break;r(n)}if(e((15&s)<<4>>>0|(60&o)>>2),null!==(n=t())){if(s=i[n],"undefined"==typeof s){if(61===n)break;r(n)}e((3&o)<<6>>>0|s)}}},t.test=function(t){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(t)},t}();s.toBase64=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),t|=0,e|=0,t<0||e>this.capacity||t>e)throw RangeError("begin, end");var r;return f.encode(function(){return t<e?this.view[t++]:null}.bind(this),r=i()),r()},o.fromBase64=function(t,i){if("string"!=typeof t)throw TypeError("str");var r=new o(t.length/4*3,i),n=0;return f.decode(e(t),function(t){r.view[n++]=t}),r.limit=n,r},o.btoa=function(t){return o.fromBinary(t).toBase64()},o.atob=function(t){return o.fromBase64(t).toBinary()},s.toBinary=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),t|=0,e|=0,t<0||e>this.capacity()||t>e)throw RangeError("begin, end");if(t===e)return"";for(var i=[],r=[];t<e;)i.push(this.view[t++]),i.length>=1024&&(r.push(String.fromCharCode.apply(String,i)),i=[]);return r.join("")+String.fromCharCode.apply(String,i)},o.fromBinary=function(t,e){if("string"!=typeof t)throw TypeError("str");for(var i,r=0,n=t.length,s=new o(n,e);r<n;){if(i=t.charCodeAt(r),i>255)throw RangeError("illegal char code: "+i);s.view[r++]=i}return s.limit=n,s},s.toDebug=function(t){for(var e,i=-1,r=this.buffer.byteLength,n="",o="",s="";i<r;){if(i!==-1&&(e=this.view[i],n+=e<16?"0"+e.toString(16).toUpperCase():e.toString(16).toUpperCase(),t&&(o+=e>32&&e<127?String.fromCharCode(e):".")),++i,t&&i>0&&i%16===0&&i!==r){for(;n.length<51;)n+=" ";s+=n+o+"\n",n=o=""}n+=i===this.offset&&i===this.limit?i===this.markedOffset?"!":"|":i===this.offset?i===this.markedOffset?"[":"<":i===this.limit?i===this.markedOffset?"]":">":i===this.markedOffset?"'":t||0!==i&&i!==r?" ":""}if(t&&" "!==n){for(;n.length<51;)n+=" ";s+=n+o+"\n"}return t?s:n},o.fromDebug=function(t,e,i){for(var r,n,s=t.length,a=new o((s+1)/3|0,e,i),h=0,f=0,l=!1,u=!1,c=!1,p=!1,d=!1;h<s;){switch(r=t.charAt(h++)){case"!":if(!i){if(u||c||p){d=!0;break}u=c=p=!0}a.offset=a.markedOffset=a.limit=f,l=!1;
break;case"|":if(!i){if(u||p){d=!0;break}u=p=!0}a.offset=a.limit=f,l=!1;break;case"[":if(!i){if(u||c){d=!0;break}u=c=!0}a.offset=a.markedOffset=f,l=!1;break;case"<":if(!i){if(u){d=!0;break}u=!0}a.offset=f,l=!1;break;case"]":if(!i){if(p||c){d=!0;break}p=c=!0}a.limit=a.markedOffset=f,l=!1;break;case">":if(!i){if(p){d=!0;break}p=!0}a.limit=f,l=!1;break;case"'":if(!i){if(c){d=!0;break}c=!0}a.markedOffset=f,l=!1;break;case" ":l=!1;break;default:if(!i&&l){d=!0;break}if(n=parseInt(r+t.charAt(h++),16),!i&&(isNaN(n)||n<0||n>255))throw TypeError("Illegal str: Not a debug encoded string");a.view[f++]=n,l=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+h)}if(!i){if(!u||!p)throw TypeError("Illegal str: Missing offset or limit");if(f<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+f+" < "+s)}return a},s.toHex=function(t,e){if(t="undefined"==typeof t?this.offset:t,e="undefined"==typeof e?this.limit:e,!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}for(var i,r=new Array(e-t);t<e;)i=this.view[t++],i<16?r.push("0",i.toString(16)):r.push(i.toString(16));return r.join("")},o.fromHex=function(t,e,i){if(!i){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,n=t.length,s=new o(n/2|0,e),a=0,h=0;a<n;a+=2){if(r=parseInt(t.substring(a,a+2),16),!i&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");s.view[h++]=r}return s.limit=h,s};var l=function(){var t={};return t.MAX_CODEPOINT=1114111,t.encodeUTF8=function(t,e){var i=null;for("number"==typeof t&&(i=t,t=function(){return null});null!==i||null!==(i=t());)i<128?e(127&i):i<2048?(e(i>>6&31|192),e(63&i|128)):i<65536?(e(i>>12&15|224),e(i>>6&63|128),e(63&i|128)):(e(i>>18&7|240),e(i>>12&63|128),e(i>>6&63|128),e(63&i|128)),i=null},t.decodeUTF8=function(t,e){for(var i,r,n,o,s=function(t){t=t.slice(0,t.indexOf(null));var e=Error(t.toString());throw e.name="TruncatedError",e.bytes=t,e};null!==(i=t());)if(0===(128&i))e(i);else if(192===(224&i))null===(r=t())&&s([i,r]),e((31&i)<<6|63&r);else if(224===(240&i))(null===(r=t())||null===(n=t()))&&s([i,r,n]),e((15&i)<<12|(63&r)<<6|63&n);else{if(240!==(248&i))throw RangeError("Illegal starting byte: "+i);(null===(r=t())||null===(n=t())||null===(o=t()))&&s([i,r,n,o]),e((7&i)<<18|(63&r)<<12|(63&n)<<6|63&o)}},t.UTF16toUTF8=function(t,e){for(var i,r=null;;){if(null===(i=null!==r?r:t()))break;i>=55296&&i<=57343&&null!==(r=t())&&r>=56320&&r<=57343?(e(1024*(i-55296)+r-56320+65536),r=null):e(i)}null!==r&&e(r)},t.UTF8toUTF16=function(t,e){var i=null;for("number"==typeof t&&(i=t,t=function(){return null});null!==i||null!==(i=t());)i<=65535?e(i):(i-=65536,e((i>>10)+55296),e(i%1024+56320)),i=null},t.encodeUTF16toUTF8=function(e,i){t.UTF16toUTF8(e,function(e){t.encodeUTF8(e,i)})},t.decodeUTF8toUTF16=function(e,i){t.decodeUTF8(e,function(e){t.UTF8toUTF16(e,i)})},t.calculateCodePoint=function(t){return t<128?1:t<2048?2:t<65536?3:4},t.calculateUTF8=function(t){for(var e,i=0;null!==(e=t());)i+=e<128?1:e<2048?2:e<65536?3:4;return i},t.calculateUTF16asUTF8=function(e){var i=0,r=0;return t.UTF16toUTF8(e,function(t){++i,r+=t<128?1:t<2048?2:t<65536?3:4}),[i,r]},t}();return s.toUTF8=function(t,e){if("undefined"==typeof t&&(t=this.offset),"undefined"==typeof e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||t>e||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}var r;try{l.decodeUTF8toUTF16(function(){return t<e?this.view[t++]:null}.bind(this),r=i())}catch(i){if(t!==e)throw RangeError("Illegal range: Truncated data, "+t+" != "+e)}return r()},o.fromUTF8=function(t,i,r){if(!r&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var n=new o(l.calculateUTF16asUTF8(e(t),!0)[1],i,r),s=0;return l.encodeUTF16toUTF8(e(t),function(t){n.view[s++]=t}),n.limit=s,n},o})},{long:71}],74:[function(t,e,i){(function(i){!function(i,r){"function"==typeof define&&define.amd?define(["bytebuffer"],r):"function"==typeof t&&"object"==typeof e&&e&&e.exports?e.exports=r(t("bytebuffer"),!0):(i.dcodeIO=i.dcodeIO||{}).ProtoBuf=r(i.dcodeIO.ByteBuffer)}(this,function(e,r){"use strict";var n={};return n.ByteBuffer=e,n.Long=e.Long||null,n.VERSION="5.0.1",n.WIRE_TYPES={},n.WIRE_TYPES.VARINT=0,n.WIRE_TYPES.BITS64=1,n.WIRE_TYPES.LDELIM=2,n.WIRE_TYPES.STARTGROUP=3,n.WIRE_TYPES.ENDGROUP=4,n.WIRE_TYPES.BITS32=5,n.PACKABLE_WIRE_TYPES=[n.WIRE_TYPES.VARINT,n.WIRE_TYPES.BITS64,n.WIRE_TYPES.BITS32],n.TYPES={int32:{name:"int32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.ZERO:void 0},uint64:{name:"uint64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.UZERO:void 0},sint64:{name:"sint64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.ZERO:void 0},bool:{name:"bool",wireType:n.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:n.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:n.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:n.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:n.WIRE_TYPES.BITS64,defaultValue:n.Long?n.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:n.WIRE_TYPES.BITS64,defaultValue:n.Long?n.Long.ZERO:void 0},float:{name:"float",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:n.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:n.WIRE_TYPES.STARTGROUP,defaultValue:null}},n.MAP_KEY_TYPES=[n.TYPES.int32,n.TYPES.sint32,n.TYPES.sfixed32,n.TYPES.uint32,n.TYPES.fixed32,n.TYPES.int64,n.TYPES.sint64,n.TYPES.sfixed64,n.TYPES.uint64,n.TYPES.fixed64,n.TYPES.bool,n.TYPES.string,n.TYPES.bytes],n.ID_MIN=1,n.ID_MAX=536870911,n.convertFieldsToCamelCase=!1,n.populateAccessors=!0,n.populateDefaults=!0,n.Util=function(){var e={};return e.IS_NODE=!("object"!=typeof i||i+""!="[object process]"||i.browser),e.XHR=function(){for(var t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],e=null,i=0;i<t.length;i++){try{e=t[i]()}catch(t){continue}break}if(!e)throw Error("XMLHttpRequest is not supported");return e},e.fetch=function(i,r){if(r&&"function"!=typeof r&&(r=null),e.IS_NODE){var n=t("fs");if(r)n.readFile(i,function(t,e){r(t?null:""+e)});else try{return n.readFileSync(i)}catch(t){return null}}else{var o=e.XHR();if(o.open("GET",i,!!r),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!r)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&r(200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null)},4==o.readyState)return;o.send(null)}},e.toCamelCase=function(t){return t.replace(/_([a-zA-Z])/g,function(t,e){return e.toUpperCase()})},e}(),n.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},n.DotProto=function(t,e){function i(t,i){var r=-1,n=1;if("-"==t.charAt(0)&&(n=-1,t=t.substring(1)),e.NUMBER_DEC.test(t))r=parseInt(t);else if(e.NUMBER_HEX.test(t))r=parseInt(t.substring(2),16);else{if(!e.NUMBER_OCT.test(t))throw Error("illegal id value: "+(n<0?"-":"")+t);r=parseInt(t.substring(1),8)}if(r=n*r|0,!i&&r<0)throw Error("illegal id value: "+(n<0?"-":"")+t);return r}function r(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),e.NUMBER_DEC.test(t))return i*parseInt(t,10);if(e.NUMBER_HEX.test(t))return i*parseInt(t.substring(2),16);if(e.NUMBER_OCT.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(e.NUMBER_FLT.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function n(t,e,i){"undefined"==typeof t[e]?t[e]=i:(Array.isArray(t[e])||(t[e]=[t[e]]),t[e].push(i))}var o={},s=function(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},a=s.prototype;a._readString=function(){var t='"'===this._stringOpen?e.STRING_DQ:e.STRING_SQ;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,i[1]},a.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var t,i,r;do{for(t=!1;e.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;i=r,r=this.source.charAt(this.index)}while("*"!==i||"/"!==r);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var n=this.index;e.DELIM.lastIndex=0;var o=e.DELIM.test(this.source.charAt(n++));if(!o)for(;n<this.source.length&&!e.DELIM.test(this.source.charAt(n));)++n;var s=this.source.substring(this.index,this.index=n);return'"'!==s&&"'"!==s||(this._stringOpen=s),s},a.peek=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},a.skip=function(t){var e=this.next();if(e!==t)throw Error("illegal '"+e+"', '"+t+"' expected")},a.omit=function(t){return this.peek()===t&&(this.next(),!0)},a.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},o.Tokenizer=s;var h=function(t){this.tn=new s(t),this.proto3=!1},f=h.prototype;return f.parse=function(){var t,i,r={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},n=!0;try{for(;t=this.tn.next();)switch(t){case"package":if(!n||null!==r.package)throw Error("unexpected 'package'");if(t=this.tn.next(),!e.TYPEREF.test(t))throw Error("illegal package name: "+t);this.tn.skip(";"),r.package=t;break;case"import":if(!n)throw Error("unexpected 'import'");t=this.tn.peek(),("public"===t||(i="weak"===t))&&this.tn.next(),t=this._readString(),this.tn.skip(";"),i||r.imports.push(t);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(r.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(r,null),n=!1;break;case"enum":this._parseEnum(r),n=!1;break;case"option":this._parseOption(r);break;case"service":this._parseService(r);break;case"extend":this._parseExtend(r);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.tn.line+": "+t.message,t}return delete r.name,r},h.parse=function(t){return new h(t).parse()},f._readString=function(){var t,e,i="";do{if(e=this.tn.next(),"'"!==e&&'"'!==e)throw Error("illegal string delimiter: "+e);i+=this.tn.next(),this.tn.skip(e),t=this.tn.peek()}while('"'===t||'"'===t);return i},f._readValue=function(t){var i=this.tn.peek();if('"'===i||"'"===i)return this._readString();if(this.tn.next(),e.NUMBER.test(i))return r(i);if(e.BOOL.test(i))return"true"===i.toLowerCase();if(t&&e.TYPEREF.test(i))return i;throw Error("illegal value: "+i)},f._parseOption=function(t,i){var r=this.tn.next(),n=!1;if("("===r&&(n=!0,r=this.tn.next()),!e.TYPEREF.test(r))throw Error("illegal option name: "+r);var o=r;n&&(this.tn.skip(")"),o="("+o+")",r=this.tn.peek(),e.FQTYPEREF.test(r)&&(o+=r,this.tn.next())),this.tn.skip("="),this._parseOptionValue(t,o),i||this.tn.skip(";")},f._parseOptionValue=function(t,i){var r=this.tn.peek();if("{"!==r)n(t.options,i,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!e.NAME.test(r))throw Error("illegal option name: "+i+"."+r);this.tn.omit(":")?n(t.options,i+"."+r,this._readValue(!0)):this._parseOptionValue(t,i+"."+r)}},f._parseService=function(t){var i=this.tn.next();if(!e.NAME.test(i))throw Error("illegal service name at line "+this.tn.line+": "+i);var r=i,n={name:r,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if("option"===i)this._parseOption(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this._parseServiceRPC(n)}this.tn.omit(";"),t.services.push(n)},f._parseServiceRPC=function(t){var i="rpc",r=this.tn.next();if(!e.NAME.test(r))throw Error("illegal rpc service method name: "+r);var n=r,o={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),r=this.tn.next(),"stream"===r.toLowerCase()&&(o.request_stream=!0,r=this.tn.next()),!e.TYPEREF.test(r))throw Error("illegal rpc service request type: "+r);if(o.request=r,this.tn.skip(")"),r=this.tn.next(),"returns"!==r.toLowerCase())throw Error("illegal rpc service request type delimiter: "+r);if(this.tn.skip("("),r=this.tn.next(),"stream"===r.toLowerCase()&&(o.response_stream=!0,r=this.tn.next()),o.response=r,this.tn.skip(")"),r=this.tn.peek(),"{"===r){for(this.tn.next();"}"!==(r=this.tn.next());){if("option"!==r)throw Error("illegal rpc service token: "+r);this._parseOption(o)}this.tn.omit(";")}else this.tn.skip(";");"undefined"==typeof t[i]&&(t[i]={}),t[i][n]=o},f._parseMessage=function(t,r){var n=!!r,o=this.tn.next(),s={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!e.NAME.test(o))throw Error("illegal "+(n?"group":"message")+" name: "+o);for(s.name=o,n&&(this.tn.skip("="),r.id=i(this.tn.next()),s.isGroup=!0),o=this.tn.peek(),"["===o&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(o=this.tn.next());)if(e.RULE.test(o))this._parseMessageField(s,o);else if("oneof"===o)this._parseMessageOneOf(s);else if("enum"===o)this._parseEnum(s);else if("message"===o)this._parseMessage(s);else if("option"===o)this._parseOption(s);else if("service"===o)this._parseService(s);else if("extensions"===o)s.extensions=this._parseExtensionRanges();else if("reserved"===o)this._parseIgnored();else if("extend"===o)this._parseExtend(s);else{if(!e.TYPEREF.test(o))throw Error("illegal message token: "+o);if(!this.proto3)throw Error("illegal field rule: "+o);this._parseMessageField(s,"optional",o)}return this.tn.omit(";"),t.messages.push(s),s},f._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},f._parseMessageField=function(t,r,n){if(!e.RULE.test(r))throw Error("illegal message field rule: "+r);var o,s={rule:r,type:"",name:"",options:{},id:0};if("map"===r){if(n)throw Error("illegal type: "+n);if(this.tn.skip("<"),o=this.tn.next(),!e.TYPE.test(o)&&!e.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(s.keytype=o,this.tn.skip(","),o=this.tn.next(),!e.TYPE.test(o)&&!e.TYPEREF.test(o))throw Error("illegal message field: "+o);if(s.type=o,this.tn.skip(">"),o=this.tn.next(),!e.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=i(this.tn.next()),o=this.tn.peek(),"["===o&&this._parseFieldOptions(s),this.tn.skip(";")}else if(n="undefined"!=typeof n?n:this.tn.next(),"group"===n){var a=this._parseMessage(t,s);if(!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);s.type=a.name,s.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!e.TYPE.test(n)&&!e.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(s.type=n,o=this.tn.next(),!e.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=i(this.tn.next()),o=this.tn.peek(),"["===o&&this._parseFieldOptions(s),this.tn.skip(";")}return t.fields.push(s),s},f._parseMessageOneOf=function(t){var i=this.tn.next();if(!e.NAME.test(i))throw Error("illegal oneof name: "+i);var r,n=i,o=[];for(this.tn.skip("{");"}"!==(i=this.tn.next());)r=this._parseMessageField(t,"optional",i),r.oneof=n,o.push(r.id);this.tn.omit(";"),t.oneofs[n]=o},f._parseFieldOptions=function(t){this.tn.skip("[");for(var e,i=!0;"]"!==(e=this.tn.peek());)i||this.tn.skip(","),this._parseOption(t,!0),i=!1;this.tn.next()},f._parseEnum=function(t){var r={name:"",values:[],options:{}},n=this.tn.next();if(!e.NAME.test(n))throw Error("illegal name: "+n);for(r.name=n,this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(r);else{if(!e.NAME.test(n))throw Error("illegal name: "+n);this.tn.skip("=");var o={name:n,id:i(this.tn.next(),!0)};n=this.tn.peek(),"["===n&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),r.values.push(o)}this.tn.omit(";"),t.enums.push(r)},f._parseExtensionRanges=function(){var e,i,n,o=[];do{for(i=[];;){switch(e=this.tn.next()){case"min":n=t.ID_MIN;break;case"max":n=t.ID_MAX;break;default:n=r(e)}if(i.push(n),2===i.length)break;if("to"!==this.tn.peek()){i.push(n);break}this.tn.next()}o.push(i)}while(this.tn.omit(","));return this.tn.skip(";"),o},f._parseExtend=function(t){var i=this.tn.next();if(!e.TYPEREF.test(i))throw Error("illegal extend reference: "+i);var r={ref:i,fields:[]};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if(e.RULE.test(i))this._parseMessageField(r,i);else{if(!e.TYPEREF.test(i))throw Error("illegal extend token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(r,"optional",i)}return this.tn.omit(";"),t.messages.push(r),r},f.toString=function(){return"Parser at line "+this.tn.line},o.Parser=h,o}(n,n.Lang),n.Reflect=function(t){function i(i){if("string"==typeof i&&(i=t.TYPES[i]),"undefined"==typeof i.defaultValue)throw Error("default value for type "+i.name+" is not supported");return i==t.TYPES.bytes?new e(0):i.defaultValue}function r(e,i){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new t.Long(e.low,e.high,"undefined"==typeof i?e.unsigned:i);if("string"==typeof e)return t.Long.fromString(e,i||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,i||!1);throw Error("not convertible to Long")}function n(e,i){var r=i.readVarint32(),o=7&r,s=r>>>3;switch(o){case t.WIRE_TYPES.VARINT:do r=i.readUint8();while(128===(128&r));break;case t.WIRE_TYPES.BITS64:i.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=i.readVarint32(),i.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:n(s,i);break;case t.WIRE_TYPES.ENDGROUP:if(s===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+o)}return!0}var o={},s=function(t,e,i){this.builder=t,this.parent=e,this.name=i,this.className},a=s.prototype;a.fqn=function(){for(var t=this.name,e=this;;){if(e=e.parent,null==e)break;t=e.name+"."+t}return t},a.toString=function(t){return(t?this.className+" ":"")+this.fqn()},a.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},o.T=s;var h=function(t,e,i,r,n){s.call(this,t,e,i),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=n||"proto2"},f=h.prototype=Object.create(s.prototype);f.getChildren=function(t){if(t=t||null,null==t)return this.children.slice();for(var e=[],i=0,r=this.children.length;i<r;++i)this.children[i]instanceof t&&e.push(this.children[i]);return e},f.addChild=function(t){var e;if(e=this.getChild(t.name))if(e instanceof c.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName))e.name=e.originalName;else{if(!(t instanceof c.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.originalName}this.children.push(t)},f.getChild=function(t){for(var e="number"==typeof t?"id":"name",i=0,r=this.children.length;i<r;++i)if(this.children[i][e]===t)return this.children[i];return null},f.resolve=function(t,e){var i="string"==typeof t?t.split("."):t,r=this,n=0;if(""===i[n]){for(;null!==r.parent;)r=r.parent;n++}var s;do{do{if(!(r instanceof o.Namespace)){r=null;break}if(s=r.getChild(i[n]),!s||!(s instanceof o.T)||e&&!(s instanceof o.Namespace)){r=null;break}r=s,n++}while(n<i.length);if(null!=r)break;if(null!==this.parent)return this.parent.resolve(t,e)}while(null!=r);return r},f.qn=function(t){var e=[],i=t;do e.unshift(i.name),i=i.parent;while(null!==i);for(var r=1;r<=e.length;r++){var n=e.slice(e.length-r);if(t===this.resolve(n,t instanceof o.Namespace))return n.join(".")}return t.fqn()},f.build=function(){for(var t,e={},i=this.children,r=0,n=i.length;r<n;++r)t=i[r],t instanceof h&&(e[t.name]=t.build());return Object.defineProperty&&Object.defineProperty(e,"$options",{value:this.buildOpt()}),e},f.buildOpt=function(){for(var t={},e=Object.keys(this.options),i=0,r=e.length;i<r;++i){var n=e[i],o=this.options[e[i]];t[n]=o}return t},f.getOption=function(t){return"undefined"==typeof t?this.options:"undefined"!=typeof this.options[t]?this.options[t]:null},o.Namespace=h;var l=function(e,i,r,n){if(this.type=e,this.resolvedType=i,this.isMapKey=r,this.syntax=n,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},u=l.prototype;l.defaultFieldValue=i,u.verifyValue=function(i){function n(t,e){throw Error("Illegal value for "+o.toString(!0)+" of type "+o.type.name+": "+t+" ("+e+")")}var o=this;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),i>4294967295?0|i:i;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return r(i,!1)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return r(i,!0)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof i&&n(typeof i,"not a number"),i;case t.TYPES.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case t.TYPES.bytes:return e.isByteBuffer(i)?i:e.wrap(i,"base64");case t.TYPES.enum:var s=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(h=0;h<s.length;h++){if(s[h].name==i)return s[h].id;if(s[h].id==i)return s[h].id}if("proto3"===this.syntax)return("number"!=typeof i||i===i&&i%1!==0)&&n(typeof i,"not an integer"),(i>4294967295||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.resolvedType.clazz)return i;if(i instanceof t.Builder.Message){var a={};for(var h in i)i.hasOwnProperty(h)&&(a[h]=i[h]);i=a}return new this.resolvedType.clazz(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},u.calculateLength=function(i,r){if(null===r)return 0;var n;switch(this.type){case t.TYPES.int32:return r<0?e.calculateVarint64(r):e.calculateVarint32(r);case t.TYPES.uint32:return e.calculateVarint32(r);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(r);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return e.calculateVarint32(r);case t.TYPES.double:return 8;case t.TYPES.string:return n=e.calculateUTF8Bytes(r),e.calculateVarint32(n)+n;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return e.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return n=this.resolvedType.calculate(r),e.calculateVarint32(n)+n;case t.TYPES.group:return n=this.resolvedType.calculate(r),n+e.calculateVarint32(i<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},u.encodeValue=function(i,r,n){if(null===r)return n;switch(this.type){case t.TYPES.int32:r<0?n.writeVarint64(r):n.writeVarint32(r);break;case t.TYPES.uint32:n.writeVarint32(r);break;case t.TYPES.sint32:n.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:n.writeUint32(r);break;case t.TYPES.sfixed32:n.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:n.writeVarint64(r);break;case t.TYPES.sint64:n.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:n.writeUint64(r);break;case t.TYPES.sfixed64:n.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?n.writeVarint32("false"===r.toLowerCase()?0:!!r):n.writeVarint32(r?1:0);break;case t.TYPES.enum:n.writeVarint32(r);break;case t.TYPES.float:n.writeFloat32(r);break;case t.TYPES.double:n.writeFloat64(r);break;case t.TYPES.string:n.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");var o=r.offset;n.writeVarint32(r.remaining()),n.append(r),r.offset=o;break;case t.TYPES.message:var s=(new e).LE();this.resolvedType.encode(r,s),n.writeVarint32(s.offset),n.append(s.flip());break;case t.TYPES.group:this.resolvedType.encode(r,n),n.writeVarint32(i<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return n},u.decode=function(e,i,r){if(i!=this.type.wireType)throw Error("Unexpected wire type for element");var n,o;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(o=e.readVarint32(),e.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+e.remaining());return n=e.clone(),n.limit=n.offset+o,e.offset+=o,n;case t.TYPES.message:return o=e.readVarint32(),this.resolvedType.decode(e,o);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},u.valueFromString=function(i){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(i));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(i);case t.TYPES.bool:return"true"===i;case t.TYPES.string:return this.verifyValue(i);case t.TYPES.bytes:return e.fromBinary(i)}},u.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},o.Element=l;var c=function(t,e,i,r,n,o){h.call(this,t,e,i,r,o),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!n,this._fields=null,this._fieldsById=null,this._fieldsByName=null},p=c.prototype=Object.create(h.prototype);p.build=function(i){if(this.clazz&&!i)return this.clazz;var r=function(t,i){function r(i,n,o,s){if(null===i||"object"!=typeof i){if(s&&s instanceof t.Reflect.Enum){var a=t.Reflect.Enum.getName(s.object,i);if(null!==a)return a}return i}if(e.isByteBuffer(i))return n?i.toBase64():i.toBuffer();if(t.Long.isLong(i))return o?i.toString():t.Long.fromValue(i);var h;if(Array.isArray(i))return h=[],i.forEach(function(t,e){h[e]=r(t,n,o,s)}),h;if(h={},i instanceof t.Map){for(var f=i.entries(),l=f.next();!l.done;l=f.next())h[i.keyElem.valueToString(l.value[0])]=r(l.value[1],n,o,i.valueElem.resolvedType);return h}var u=i.$type,c=void 0;for(var p in i)i.hasOwnProperty(p)&&(u&&(c=u.getChild(p))?h[p]=r(i[p],n,o,c.resolvedType):h[p]=r(i[p],n,o));return h}var n=i.getChildren(t.Reflect.Message.Field),o=i.getChildren(t.Reflect.Message.OneOf),s=function(r,a){t.Builder.Message.call(this);for(var h=0,f=o.length;h<f;++h)this[o[h].name]=null;for(h=0,f=n.length;h<f;++h){var l=n[h];this[l.name]=l.repeated?[]:l.map?new t.Map(l):null,!l.required&&"proto3"!==i.syntax||null===l.defaultValue||(this[l.name]=l.defaultValue)}if(arguments.length>0){var u;if(1!==arguments.length||null===r||"object"!=typeof r||!("function"!=typeof r.encode||r instanceof s)||Array.isArray(r)||r instanceof t.Map||e.isByteBuffer(r)||r instanceof ArrayBuffer||t.Long&&r instanceof t.Long)for(h=0,f=arguments.length;h<f;++h)"undefined"!=typeof(u=arguments[h])&&this.$set(n[h].name,u);else this.$set(r)}},a=s.prototype=Object.create(t.Builder.Message.prototype);a.add=function(e,r,n){var o=i._fieldsByName[e];if(!n){if(!o)throw Error(this+"#"+e+" is undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+e+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[e]&&(this[e]=[]),this[e].push(r),this},a.$add=a.add,a.set=function(e,r,n){if(e&&"object"==typeof e){n=r;for(var o in e)e.hasOwnProperty(o)&&"undefined"!=typeof(r=e[o])&&this.$set(o,r,n);return this}var s=i._fieldsByName[e];if(n)this[e]=r;else{if(!s)throw Error(this+"#"+e+" is not a field: undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));this[s.name]=r=s.verifyValue(r)}if(s&&s.oneof){var a=this[s.oneof.name];null!==r?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===e&&(this[s.oneof.name]=null)}return this},a.$set=a.set,a.get=function(e,r){if(r)return this[e];var n=i._fieldsByName[e];if(!(n&&n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},a.$get=a.get;for(var h=0;h<n.length;h++){var f=n[h];f instanceof t.Reflect.Message.ExtensionField||i.builder.options.populateAccessors&&function(t){
var e=t.originalName.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});e=e.substring(0,1).toUpperCase()+e.substring(1);var r=t.originalName.replace(/([A-Z])/g,function(t){return"_"+t}),n=function(e,i){return this[t.name]=i?e:t.verifyValue(e),this},o=function(){return this[t.name]};null===i.getChild("set"+e)&&(a["set"+e]=n),null===i.getChild("set_"+r)&&(a["set_"+r]=n),null===i.getChild("get"+e)&&(a["get"+e]=o),null===i.getChild("get_"+r)&&(a["get_"+r]=o)}(f)}a.encode=function(t,r){"boolean"==typeof t&&(r=t,t=void 0);var n=!1;t||(t=new e,n=!0);var o=t.littleEndian;try{return i.encode(this,t.LE(),r),(n?t.flip():t).LE(o)}catch(e){throw t.LE(o),e}},s.encode=function(t,e,i){return new s(t).encode(e,i)},a.calculate=function(){return i.calculate(this)},a.encodeDelimited=function(t,r){var n=!1;t||(t=new e,n=!0);var o=(new e).LE();return i.encode(this,o,r).flip(),t.writeVarint32(o.remaining()),t.append(o),n?t.flip():t},a.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toArrayBuffer()),t}},a.toArrayBuffer=a.encodeAB,a.encodeNB=function(){try{return this.encode().toBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBuffer()),t}},a.toBuffer=a.encodeNB,a.encode64=function(){try{return this.encode().toBase64()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBase64()),t}},a.toBase64=a.encode64,a.encodeHex=function(){try{return this.encode().toHex()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toHex()),t}},a.toHex=a.encodeHex,a.toRaw=function(t,e){return r(this,!!t,!!e,this.$type)},a.encodeJSON=function(){return JSON.stringify(r(this,!0,!0,this.$type))},s.decode=function(t,r,n){"string"==typeof r&&(n=r,r=-1),"string"==typeof t&&(t=e.wrap(t,n?n:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t);var o=t.littleEndian;try{var s=i.decode(t.LE());return t.LE(o),s}catch(e){throw t.LE(o),e}},s.decodeDelimited=function(t,r){if("string"==typeof t&&(t=e.wrap(t,r?r:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t),t.remaining()<1)return null;var n=t.offset,o=t.readVarint32();if(t.remaining()<o)return t.offset=n,null;try{var s=i.decode(t.slice(t.offset,t.offset+o).LE());return t.offset+=o,s}catch(e){throw t.offset+=o,e}},s.decode64=function(t){return s.decode(t,"base64")},s.decodeHex=function(t){return s.decode(t,"hex")},s.decodeJSON=function(t){return new s(JSON.parse(t))},a.toString=function(){return i.toString()};return Object.defineProperty&&(Object.defineProperty(s,"$options",{value:i.buildOpt()}),Object.defineProperty(a,"$options",{value:s.$options}),Object.defineProperty(s,"$type",{value:i}),Object.defineProperty(a,"$type",{value:i})),s}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var n,o=0,s=this.children.length;o<s;o++)if(n=this.children[o],n instanceof m||n instanceof c||n instanceof T){if(r.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");r[n.name]=n.build()}else if(n instanceof c.Field)n.build(),this._fields.push(n),this._fieldsById[n.id]=n,this._fieldsByName[n.name]=n;else if(!(n instanceof c.OneOf||n instanceof E))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[o].toString(!0));return this.clazz=r},p.encode=function(t,e,i){for(var r,n,o=null,s=0,a=this._fields.length;s<a;++s)r=this._fields[s],n=t[r.name],r.required&&null===n?null===o&&(o=r):r.encode(i?n:r.verifyValue(n),e,t);if(null!==o){var h=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw h.encoded=e,h}return e},p.calculate=function(t){for(var e,i,r=0,n=0,o=this._fields.length;n<o;++n){if(e=this._fields[n],i=t[e.name],e.required&&null===i)throw Error("Missing at least one required field for "+this.toString(!0)+": "+e);r+=e.calculate(i,t)}return r},p.decode=function(e,i,r){i="number"==typeof i?i:-1;for(var o,s,a,h,f=e.offset,l=new this.clazz;e.offset<f+i||i===-1&&e.remaining()>0;){if(o=e.readVarint32(),s=7&o,a=o>>>3,s===t.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(h=this._fieldsById[a]){if(h.repeated&&!h.options.packed)l[h.name].push(h.decode(s,e));else if(h.map){var u=h.decode(s,e);l[h.name].set(u[0],u[1])}else if(l[h.name]=h.decode(s,e),h.oneof){var c=l[h.oneof.name];null!==c&&c!==h.name&&(l[c]=null),l[h.oneof.name]=h.name}}else switch(s){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var p=e.readVarint32();e.offset+=p;break;case t.WIRE_TYPES.STARTGROUP:for(;n(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(var d=0,y=this._fields.length;d<y;++d)if(h=this._fields[d],null===l[h.name])if("proto3"===this.syntax)l[h.name]=h.defaultValue;else{if(h.required){var g=Error("Missing at least one required field for "+this.toString(!0)+": "+h.name);throw g.decoded=l,g}t.populateDefaults&&null!==h.defaultValue&&(l[h.name]=h.defaultValue)}return l},o.Message=c;var d=function(e,i,r,n,o,a,h,f,l,u){s.call(this,e,i,a),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=n||null,this.type=o,this.resolvedType=null,this.id=h,this.options=f||{},this.defaultValue=null,this.oneof=l||null,this.syntax=u||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof c.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},y=d.prototype=Object.create(s.prototype);y.build=function(){this.element=new l(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new l(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?"undefined"!=typeof this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=l.defaultFieldValue(this.type)},y.verifyValue=function(e,i){function r(t,e){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+t+" ("+e+")")}i=i||!1;var n=this;if(null===e)return this.required&&r(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&r(typeof e,"proto3 field without field presence cannot be null"),null;var o;if(this.repeated&&!i){Array.isArray(e)||(e=[e]);var s=[];for(o=0;o<e.length;o++)s.push(this.element.verifyValue(e[o]));return s}return this.map&&!i?e instanceof t.Map?e:(e instanceof Object||r(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(typeof e,"no array expected"),this.element.verifyValue(e))},y.hasWirePresence=function(e,i){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&i[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},y.encode=function(i,r,n){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return r;try{if(this.repeated){var o;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1);var s=r.offset;for(o=0;o<i.length;o++)this.element.encodeValue(this.id,i[o],r);var a=r.offset-s,h=e.calculateVarint32(a);if(h>1){var f=r.slice(s,r.offset);s+=h-1,r.offset=s,r.append(f)}r.writeVarint32(a,s-h)}else for(o=0;o<i.length;o++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i[o],r)}else this.map?i.forEach(function(i,n,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(s),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,n,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,i,r)},this):this.hasWirePresence(i,n)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i,r))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return r},y.calculate=function(i,r){if(i=this.verifyValue(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var n=0;try{if(this.repeated){var o,s;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s=0,o=0;o<i.length;o++)s+=this.element.calculateLength(this.id,i[o]);n+=e.calculateVarint32(s),n+=s}else for(o=0;o<i.length;o++)n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i[o])}else this.map?i.forEach(function(i,r,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n+=e.calculateVarint32(s),n+=s},this):this.hasWirePresence(i,r)&&(n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return n},y.decode=function(e,i,r){var n,o,s=!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM;if(!s)throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){o=i.readVarint32(),o=i.offset+o;for(var a=[];i.offset<o;)a.push(this.decode(this.type.wireType,i,!0));return a}if(this.map){var h=l.defaultFieldValue(this.keyType);if(n=l.defaultFieldValue(this.type),o=i.readVarint32(),i.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+i.remaining());var f=i.clone();for(f.limit=f.offset+o,i.offset+=o;f.remaining()>0;){var u=f.readVarint32();e=7&u;var c=u>>>3;if(1===c)h=this.keyElement.decode(f,e,c);else{if(2!==c)throw Error("Unexpected tag in map field key/value submessage");n=this.element.decode(f,e,c)}}return[h,n]}return this.element.decode(i,e,this.id)},o.Message.Field=d;var g=function(t,e,i,r,n,o,s){d.call(this,t,e,i,null,r,n,o,s),this.extension};g.prototype=Object.create(d.prototype),o.Message.ExtensionField=g;var v=function(t,e,i){s.call(this,t,e,i),this.fields=[]};o.Message.OneOf=v;var m=function(t,e,i,r,n){h.call(this,t,e,i,r,n),this.className="Enum",this.object=null};m.getName=function(t,e){for(var i,r=Object.keys(t),n=0;n<r.length;++n)if(t[i=r[n]]===e)return i;return null};var w=m.prototype=Object.create(h.prototype);w.build=function(e){if(this.object&&!e)return this.object;for(var i=new t.Builder.Enum,r=this.getChildren(m.Value),n=0,o=r.length;n<o;++n)i[r[n].name]=r[n].id;return Object.defineProperty&&Object.defineProperty(i,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=i},o.Enum=m;var b=function(t,e,i,r){s.call(this,t,e,i),this.className="Enum.Value",this.id=r};b.prototype=Object.create(s.prototype),o.Enum.Value=b;var E=function(t,e,i,r){s.call(this,t,e,i),this.field=r};E.prototype=Object.create(s.prototype),o.Extension=E;var T=function(t,e,i,r){h.call(this,t,e,i,r),this.className="Service",this.clazz=null},x=T.prototype=Object.create(h.prototype);x.build=function(i){return this.clazz&&!i?this.clazz:this.clazz=function(t,i){for(var r=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(t,e,i){setTimeout(i.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},n=r.prototype=Object.create(t.Builder.Service.prototype),o=i.getChildren(t.Reflect.Service.RPCMethod),s=0;s<o.length;s++)!function(t){n[t.name]=function(r,n){try{try{r=t.resolvedRequestType.clazz.decode(e.wrap(r))}catch(t){if(!(t instanceof TypeError))throw t}if(null===r||"object"!=typeof r)throw Error("Illegal arguments");r instanceof t.resolvedRequestType.clazz||(r=new t.resolvedRequestType.clazz(r)),this.rpcImpl(t.fqn(),r,function(e,r){if(e)return void n(e);null===r&&(r="");try{r=t.resolvedResponseType.clazz.decode(r)}catch(t){}return r&&r instanceof t.resolvedResponseType.clazz?void n(null,r):void n(Error("Illegal response type received in service method "+i.name+"#"+t.name))})}catch(t){setTimeout(n.bind(this,t),0)}},r[t.name]=function(e,i,n){new r(e)[t.name](i,n)},Object.defineProperty&&(Object.defineProperty(r[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(n[t.name],"$options",{value:r[t.name].$options}))}(o[s]);return Object.defineProperty&&(Object.defineProperty(r,"$options",{value:i.buildOpt()}),Object.defineProperty(n,"$options",{value:r.$options}),Object.defineProperty(r,"$type",{value:i}),Object.defineProperty(n,"$type",{value:i})),r}(t,this)},o.Service=T;var S=function(t,e,i,r){s.call(this,t,e,i),this.className="Service.Method",this.options=r||{}},k=S.prototype=Object.create(s.prototype);k.buildOpt=f.buildOpt,o.Service.Method=S;var I=function(t,e,i,r,n,o,s,a){S.call(this,t,e,i,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=n,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null};return I.prototype=Object.create(S.prototype),o.Service.RPCMethod=I,o}(n),n.Builder=function(e,i,r){function n(t){t.messages&&t.messages.forEach(function(e){e.syntax=t.syntax,n(e)}),t.enums&&t.enums.forEach(function(e){e.syntax=t.syntax})}var o=function(t){this.ns=new r.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=t||{}},s=o.prototype;return o.isMessage=function(t){return"string"==typeof t.name&&("undefined"==typeof t.values&&"undefined"==typeof t.rpc)},o.isMessageField=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&"undefined"!=typeof t.id},o.isEnum=function(t){return"string"==typeof t.name&&!("undefined"==typeof t.values||!Array.isArray(t.values)||0===t.values.length)},o.isService=function(t){return!("string"!=typeof t.name||"object"!=typeof t.rpc||!t.rpc)},o.isExtend=function(t){return"string"==typeof t.ref},s.reset=function(){return this.ptr=this.ns,this},s.define=function(t){if("string"!=typeof t||!i.TYPEREF.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var e=this.ptr.getChild(t);null===e&&this.ptr.addChild(e=new r.Namespace(this,this.ptr,t)),this.ptr=e},this),this},s.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];i.length>0;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var n=t.shift();if(o.isMessage(n)){var s=new r.Message(this,this.ptr,n.name,n.options,n.isGroup,n.syntax),a={};n.oneofs&&Object.keys(n.oneofs).forEach(function(t){s.addChild(a[t]=new r.Message.OneOf(this,s,t))},this),n.fields&&n.fields.forEach(function(t){if(null!==s.getChild(0|t.id))throw Error("duplicate or invalid field id in "+s.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+s.name+"#"+t.name);var e=null;if("string"==typeof t.oneof&&!(e=a[t.oneof]))throw Error("illegal oneof in "+s.name+"#"+t.name+": "+t.oneof);t=new r.Message.Field(this,s,t.rule,t.keytype,t.type,t.name,t.id,t.options,e,n.syntax),e&&e.fields.push(t),s.addChild(t)},this);var h=[];if(n.enums&&n.enums.forEach(function(t){h.push(t)}),n.messages&&n.messages.forEach(function(t){h.push(t)}),n.services&&n.services.forEach(function(t){h.push(t)}),n.extensions&&("number"==typeof n.extensions[0]?s.extensions=[n.extensions]:s.extensions=n.extensions),this.ptr.addChild(s),h.length>0){i.push(t),t=h,h=null,this.ptr=s,s=null;continue}h=null}else if(o.isEnum(n))s=new r.Enum(this,this.ptr,n.name,n.options,n.syntax),n.values.forEach(function(t){s.addChild(new r.Enum.Value(this,s,t.name,t.id))},this),this.ptr.addChild(s);else if(o.isService(n))s=new r.Service(this,this.ptr,n.name,n.options),Object.keys(n.rpc).forEach(function(t){var e=n.rpc[t];s.addChild(new r.Service.RPCMethod(this,s,t,e.request,e.response,!!e.request_stream,!!e.response_stream,e.options))},this),this.ptr.addChild(s);else{if(!o.isExtend(n))throw Error("not a valid definition: "+JSON.stringify(n));if(s=this.ptr.resolve(n.ref,!0))n.fields.forEach(function(t){if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions){var i=!1;if(s.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(i=!0)}),!i)throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)")}var n=t.name;this.options.convertFieldsToCamelCase&&(n=e.Util.toCamelCase(n));var o=new r.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+n,t.id,t.options),a=new r.Extension(this,this.ptr,t.name,o);o.extension=a,this.ptr.addChild(a),s.addChild(o)},this);else if(!/\.?google\.protobuf\./.test(n.ref))throw Error("extended message "+n.ref+" is not defined")}n=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},s.import=function(i,r){var o="/";if("string"==typeof r){if(e.Util.IS_NODE&&(r=t("path").resolve(r)),this.files[r]===!0)return this.reset();this.files[r]=!0}else if("object"==typeof r){var s=r.root;e.Util.IS_NODE&&(s=t("path").resolve(s)),(s.indexOf("\\")>=0||r.file.indexOf("\\")>=0)&&(o="\\");var a=s+o+r.file;if(this.files[a]===!0)return this.reset();this.files[a]=!0}if(i.imports&&i.imports.length>0){var h,f=!1;"object"==typeof r?(this.importRoot=r.root,f=!0,h=this.importRoot,r=r.file,(h.indexOf("\\")>=0||r.indexOf("\\")>=0)&&(o="\\")):"string"==typeof r?this.importRoot?h=this.importRoot:r.indexOf("/")>=0?(h=r.replace(/\/[^\/]*$/,""),""===h&&(h="/")):r.indexOf("\\")>=0?(h=r.replace(/\\[^\\]*$/,""),o="\\"):h=".":h=null;for(var l=0;l<i.imports.length;l++)if("string"==typeof i.imports[l]){if(!h)throw Error("cannot determine import root");var u=i.imports[l];if("google/protobuf/descriptor.proto"===u)continue;if(u=h+o+u,this.files[u]===!0)continue;/\.proto$/i.test(u)&&!e.DotProto&&(u=u.replace(/\.proto$/,".json"));var c=e.Util.fetch(u);if(null===c)throw Error("failed to import '"+u+"' in '"+r+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(c+""),u):this.import(e.DotProto.Parser.parse(c),u)}else r?/\.(\w+)$/.test(r)?this.import(i.imports[l],r.replace(/^(.+)\.(\w+)$/,function(t,e,i){return e+"_import"+l+"."+i})):this.import(i.imports[l],r+"_import"+l):this.import(i.imports[l]);f&&(this.importRoot=null)}i.package&&this.define(i.package),i.syntax&&n(i);var p=this.ptr;return i.options&&Object.keys(i.options).forEach(function(t){p.options[t]=i.options[t]}),i.messages&&(this.create(i.messages),this.ptr=p),i.enums&&(this.create(i.enums),this.ptr=p),i.services&&(this.create(i.services),this.ptr=p),i.extends&&this.create(i.extends),this.reset()},s.resolveAll=function(){var t;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof r.Namespace)this.ptr.children.forEach(function(t){this.ptr=t,this.resolveAll()},this);else if(this.ptr instanceof r.Message.Field){if(i.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!i.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(t=(this.ptr instanceof r.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!t)throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=t,t instanceof r.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==t.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof r.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=t.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!i.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(t=this.ptr.parent.resolve(this.ptr.requestName,!0),!(t&&t instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=t,t=this.ptr.parent.resolve(this.ptr.responseName,!0),!(t&&t instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=t}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},s.build=function(t){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!t)return this.result;for(var e="string"==typeof t?t.split("."):t,i=this.result,r=0;r<e.length;r++){if(!i[e[r]]){i=null;break}i=i[e[r]]}return i},s.lookup=function(t,e){return t?this.ns.resolve(t,e):this.ns},s.toString=function(){return"Builder"},o.Message=function(){},o.Enum=function(){},o.Service=function(){},o}(n,n.Lang,n.Reflect),n.Map=function(t,e){function i(t){var e=0;return{next:function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}}var r=function(t,i){if(!t.map)throw Error("field is not a map");if(this.field=t,this.keyElem=new e.Element(t.keyType,null,!0,t.syntax),this.valueElem=new e.Element(t.type,t.resolvedType,!1,t.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var r=Object.keys(i),n=0;n<r.length;n++){var o=this.keyElem.valueFromString(r[n]),s=this.valueElem.verifyValue(i[r[n]]);this.map[this.keyElem.valueToString(o)]={key:o,value:s}}},n=r.prototype;return n.clear=function(){this.map={}},n.delete=function(t){var e=this.keyElem.valueToString(this.keyElem.verifyValue(t)),i=e in this.map;return delete this.map[e],i},n.entries=function(){for(var t,e=[],r=Object.keys(this.map),n=0;n<r.length;n++)e.push([(t=this.map[r[n]]).key,t.value]);return i(e)},n.keys=function(){for(var t=[],e=Object.keys(this.map),r=0;r<e.length;r++)t.push(this.map[e[r]].key);return i(t)},n.values=function(){for(var t=[],e=Object.keys(this.map),r=0;r<e.length;r++)t.push(this.map[e[r]].value);return i(t)},n.forEach=function(t,e){for(var i,r=Object.keys(this.map),n=0;n<r.length;n++)t.call(e,(i=this.map[r[n]]).value,i.key,this)},n.set=function(t,e){var i=this.keyElem.verifyValue(t),r=this.valueElem.verifyValue(e);return this.map[this.keyElem.valueToString(i)]={key:i,value:r},this},n.get=function(t){var e=this.keyElem.valueToString(this.keyElem.verifyValue(t));if(e in this.map)return this.map[e].value},n.has=function(t){var e=this.keyElem.valueToString(this.keyElem.verifyValue(t));return e in this.map},r}(n,n.Reflect),n.loadProto=function(t,e,i){return("string"==typeof e||e&&"string"==typeof e.file&&"string"==typeof e.root)&&(i=e,e=void 0),n.loadJson(n.DotProto.Parser.parse(t),e,i)},n.protoFromString=n.loadProto,n.loadProtoFile=function(t,e,i){if(e&&"object"==typeof e?(i=e,e=null):e&&"function"==typeof e||(e=null),e)return n.Util.fetch("string"==typeof t?t:t.root+"/"+t.file,function(r){if(null===r)return void e(Error("Failed to fetch file"));try{e(null,n.loadProto(r,i,t))}catch(t){e(t)}});var r=n.Util.fetch("object"==typeof t?t.root+"/"+t.file:t);return null===r?null:n.loadProto(r,i,t)},n.protoFromFile=n.loadProtoFile,n.newBuilder=function(t){return t=t||{},"undefined"==typeof t.convertFieldsToCamelCase&&(t.convertFieldsToCamelCase=n.convertFieldsToCamelCase),"undefined"==typeof t.populateAccessors&&(t.populateAccessors=n.populateAccessors),new n.Builder(t)},n.loadJson=function(t,e,i){return("string"==typeof e||e&&"string"==typeof e.file&&"string"==typeof e.root)&&(i=e,e=null),e&&"object"==typeof e||(e=n.newBuilder()),"string"==typeof t&&(t=JSON.parse(t)),e.import(t,i),e.resolveAll(),e},n.loadJsonFile=function(t,e,i){if(e&&"object"==typeof e?(i=e,e=null):e&&"function"==typeof e||(e=null),e)return n.Util.fetch("string"==typeof t?t:t.root+"/"+t.file,function(r){if(null===r)return void e(Error("Failed to fetch file"));try{e(null,n.loadJson(JSON.parse(r),i,t))}catch(t){e(t)}});var r=n.Util.fetch("object"==typeof t?t.root+"/"+t.file:t);return null===r?null:n.loadJson(JSON.parse(r),i,t)},n})}).call(this,t("_process"))},{_process:38,bytebuffer:73,fs:47,path:47}]},{},[11]);
