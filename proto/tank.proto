package Tank;

message Vector {
    optional float x = 1;
    optional float y = 2;
}

enum UnitType {
    UT_Tank = 1;
    UT_Weapon = 2;
    UT_Bullet = 3;
    UT_Obstacle = 4;
    UT_Hpbar = 5;
}

message Motion {
    optional Vector moveDir = 1;
    optional Vector iv = 2;
    optional Vector ev = 3;
    optional float rv = 4;
    optional Vector position = 5;
    optional float rotation = 6;
}

message Unit {
    optional uint32 id = 1;
    optional int32 type = 2;
    optional string cfgName = 3;
    optional int32 hp = 4;
    optional Motion motion = 5;
}

message Player {
    optional string connid = 1;
    optional uint32 id = 2;
    optional string name = 3;
    optional uint64 score = 4;
    optional bool die = 5;
}

message SyncStartReq {
    optional string name = 1;
    optional uint32 viewW = 2;
    optional uint32 viewH = 3;
}
message SyncStartRes {
    optional string connid = 1;
    repeated Unit units = 2;
    repeated Player players = 3;
}

message SyncUnits {
    repeated Unit units = 1;
}
message SyncUnitDie {
    optional uint32 id = 1;
}

message SyncPlayerJoin {
    optional Player player = 1;
}
message SyncPlayerQuit {
    optional string connid = 1;
}

message SyncCollision {
    optional Unit u1 = 1;
    optional Unit u2 = 2;
}

message SyncFireReq {
    optional bool fire = 1;
}
message SyncFireRes {
    optional bool fire = 1;
}

message SyncOperDir {
    optional float rotation = 1;
}
message SyncOperMove {
    optional float angle = 1;
}

enum SyncCmd {
    SYNC_START_REQ = 1;
    SYNC_START_RES = 2;
    SYNC_UNITS = 3;
    SYNC_UNIT_DIE = 4;
    SYNC_PLAYER_JOIN = 5;
    SYNC_PLAYER_QUIT = 6;
    SYNC_COLLISION = 7;
    SYNC_FIRE_REQ = 8;
    SYNC_FIRE_RES = 9;
    SYNC_OPER_DIR = 10;
    SYNC_OPER_MOVE = 11;
}

enum ErrCode {
    EC_SUCCESS = 0;
    EC_FULL = -100;
    EC_EXISTED = -101;
}

message Pkg {
    optional uint32 frame = 1;
    optional SyncCmd cmd = 2;
    optional ErrCode result = 3;
    optional SyncStartReq syncStartReq = 11;
    optional SyncStartRes syncStartRes = 12;
    optional SyncUnits syncUnits = 13;
    optional SyncUnitDie syncUnitDie = 14;
    optional SyncPlayerJoin syncPlayerJoin = 15;
    optional SyncPlayerQuit syncPlayerQuit = 16;
    optional SyncCollision syncCollision = 17;
    optional SyncFireReq syncFireReq = 18;
    optional SyncFireRes syncFireRes = 19;
    optional SyncOperDir syncOperDir = 20;
    optional SyncOperMove syncOperMove = 21;
}

